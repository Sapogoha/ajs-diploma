(()=>{"use strict";function e(e,t){const a=t*t;return 0===e?"top-left":e===t-1?"top-right":e===a-t?"bottom-left":e===a-1?"bottom-right":e>0&&e<t-1?"top":e<a-1&&e>a-t?"bottom":e%t==0?"left":e%t==t-1?"right":"center"}function t(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;const s=[];function i(e){return Math.ceil((e+1)/a)}for(let r=1;r<=t;r++){const t=e-a*r,h=e+a*r,n=e-1*r,l=e+1*r,o=e-(a-1)*r,c=e-(a+1)*r,m=e+(a+1)*r,d=e+(a-1)*r,p=i(e);t>=0&&s.push(t),h<=a**2-1&&s.push(h),p===i(n)&&s.push(n),p===i(l)&&s.push(l),o>0&&p-r===i(o)&&s.push(o),c>=0&&p-r===i(c)&&s.push(c),m<=a**2-1&&p+r===i(m)&&s.push(m),d<a**2-1&&p+r===i(d)&&s.push(d)}return s}function a(e,a,s){return t(e,s).includes(a)}function s(e){return new Promise((t=>{setTimeout((()=>{t(!0)}),e)}))}class i{constructor(){this.boardSize=8,this.container=null,this.boardEl=null,this.cells=[],this.cellClickListeners=[],this.cellEnterListeners=[],this.cellLeaveListeners=[],this.newGameListeners=[],this.saveGameListeners=[],this.loadGameListeners=[]}bindToDOM(e){if(!(e instanceof HTMLElement))throw new Error("container is not HTMLElement");this.container=e}drawUi(t){this.checkBinding(),this.container.innerHTML='\n      <div class="controls">\n        <button data-id="action-restart" class="btn">New Game</button>\n        <button data-id="action-save" class="btn">Save Game</button>\n        <button data-id="action-load" class="btn">Load Game</button>\n      </div>\n      <div class="game-info">\n        <span data-id="current-level">Current level: 1</span>\n        <span data-id="current-score">Current Score: 0</span>\n        <span data-id="best-score">Best Score: 0</span>\n      </div>\n      <div class="board-container">\n        <div data-id="board" class="board"></div>\n      </div>\n    ',this.newGameEl=this.container.querySelector("[data-id=action-restart]"),this.saveGameEl=this.container.querySelector("[data-id=action-save]"),this.loadGameEl=this.container.querySelector("[data-id=action-load]"),this.currentLevel=this.container.querySelector("[data-id=current-level]"),this.currentScore=this.container.querySelector("[data-id=current-score]"),this.bestScore=this.container.querySelector("[data-id=best-score]"),this.newGameEl.addEventListener("click",(e=>this.onNewGameClick(e))),this.saveGameEl.addEventListener("click",(e=>this.onSaveGameClick(e))),this.loadGameEl.addEventListener("click",(e=>this.onLoadGameClick(e))),this.boardEl=this.container.querySelector("[data-id=board]"),this.boardEl.classList.add(t);for(let t=0;t<this.boardSize**2;t+=1){const a=document.createElement("div");a.classList.add("cell","map-tile",`map-tile-${e(t,this.boardSize)}`),a.addEventListener("mouseenter",(e=>this.onCellEnter(e))),a.addEventListener("mouseleave",(e=>this.onCellLeave(e))),a.addEventListener("click",(e=>this.onCellClick(e))),this.boardEl.appendChild(a)}this.cells=Array.from(this.boardEl.children)}redrawPositions(e){for(const e of this.cells)e.innerHTML="";for(const a of e){const e=this.boardEl.children[a.position],s=document.createElement("div");s.classList.add("character",a.character.type);const i=document.createElement("div");i.classList.add("health-level");const r=document.createElement("div");r.classList.add("health-level-indicator","health-level-indicator-"+((t=a.character.health)<15?"critical":t<50?"normal":"high")),r.style.width=`${a.character.health}%`,i.appendChild(r),s.appendChild(i),e.appendChild(s)}var t}addCellEnterListener(e){this.cellEnterListeners.push(e)}addCellLeaveListener(e){this.cellLeaveListeners.push(e)}addCellClickListener(e){this.cellClickListeners.push(e)}addNewGameListener(e){this.newGameListeners.push(e)}addSaveGameListener(e){this.saveGameListeners.push(e)}addLoadGameListener(e){this.loadGameListeners.push(e)}onCellEnter(e){e.preventDefault();const t=this.cells.indexOf(e.currentTarget);this.cellEnterListeners.forEach((e=>e.call(null,t)))}onCellLeave(e){e.preventDefault();const t=this.cells.indexOf(e.currentTarget);this.cellLeaveListeners.forEach((e=>e.call(null,t)))}onCellClick(e){const t=this.cells.indexOf(e.currentTarget);this.cellClickListeners.forEach((e=>e.call(null,t)))}onNewGameClick(e){e.preventDefault(),this.newGameListeners.forEach((e=>e.call(null)))}onSaveGameClick(e){e.preventDefault(),this.saveGameListeners.forEach((e=>e.call(null)))}onLoadGameClick(e){e.preventDefault(),this.loadGameListeners.forEach((e=>e.call(null)))}static showError(e){alert(e)}static showMessage(e){alert(e)}selectCell(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yellow";this.deselectCell(e),this.cells[e].classList.add("selected",`selected-${t}`)}deselectCell(e){const t=this.cells[e];t.classList.remove(...Array.from(t.classList).filter((e=>e.startsWith("selected"))))}showCellTooltip(e,t){this.cells[t].title=e}hideCellTooltip(e){this.cells[e].title=""}showDamage(e,t){return new Promise((a=>{const s=this.cells[e],i=document.createElement("span");i.textContent=t,i.classList.add("damage"),s.appendChild(i),i.addEventListener("animationend",(()=>{s.removeChild(i),a()}))}))}setCursor(e){this.boardEl.style.cursor=e}checkBinding(){if(null===this.container)throw new Error("GamePlay not bind to DOM")}setCurrentLevel(e){this.currentLevel.innerHTML=`Current Level: ${e}`}setCurrentScore(e){this.currentScore.innerHTML=`Current Score: ${e}`}setBestScore(e){this.bestScore.innerHTML=`Best Score: ${e}`}}const r={prairie:"prairie",desert:"desert",arctic:"arctic",mountain:"mountain"},h="pointer",n="crosshair",l="not-allowed";class o{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"generic";if(this.level=e,this.attack=0,this.defence=0,this.health=50,this.type=t,"Character"===new.target.name)throw new Error("It's not allowed to create new instances of Characters using 'new Character'. Please use classes that extend class Character instead (Bowman, Daemon, etc.)")}levelUp(){this.health>0&&(this.level+=1,this.attack=Math.max(this.attack,Math.round(this.attack*(.8+this.health/100))),this.defence=Math.max(this.defence,Math.round(this.defence*(.8+this.health/100))),this.health<20?this.health+=80:this.health=100)}}class c{constructor(e,t){if(!(e instanceof o))throw new Error("character must be instance of Character or its children");if("number"!=typeof t)throw new Error("position must be a number");this.character=e,this.position=t}levelUp(){this.health>0&&(this.level+=1,this.attack=Math.max(this.attack,Math.round(this.attack*(.8+this.health/100))),this.defence=Math.max(this.defence,Math.round(this.defence*(.8+this.health/100))),this.health<20?this.health+=80:this.health=100)}}function*m(e,t){const a=Math.floor(Math.random()*e.length),s=Math.floor(1+Math.random()*t);yield new e[a](s)}function d(e,t,a){const s=[];for(let i=0;i<a;i++)s.push(m(e,t).next().value);return s}function p(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;const s=[...Array(a**2).keys()];let i=null;"human"===t?i=s.filter((e=>e%a==0||e%a==1)):"comp"===t&&(i=s.filter((e=>e%a==6||e%a==7)));const r=[];for(let t=0;t<e.length;t++){const a=Math.floor(Math.random()*i.length),s=i[a];i.splice(a,1),r.push(new c(e[t],s))}return r}class u extends o{constructor(e){super(e,"bowman"),this.attack=25,this.defence=25,this.attackDistance=2,this.moveDistance=2,this.team="human"}}class g extends o{constructor(e){super(e,"daemon"),this.attack=10,this.defence=40,this.attackDistance=4,this.moveDistance=1,this.team="comp"}}class C extends o{constructor(e){super(e,"magician"),this.attack=10,this.defence=40,this.attackDistance=4,this.moveDistance=1,this.team="human"}}class v extends o{constructor(e){super(e,"swordsman"),this.attack=40,this.defence=10,this.attackDistance=1,this.moveDistance=4,this.team="human"}}class f extends o{constructor(e){super(e,"undead"),this.attack=40,this.defence=10,this.attackDistance=1,this.moveDistance=4,this.team="comp"}}class S extends o{constructor(e){super(e,"vampire"),this.attack=25,this.defence=25,this.attackDistance=2,this.moveDistance=2,this.team="comp"}}class y{constructor(){this.teamComp=[g,f,S],this.teamHumanInit=[u,v],this.teamHuman=[u,C,v]}}class w{constructor(){this.playersTurn=!0,this.level=1,this.points=0,this.highestPoints=0,this.positioned=[]}static from(e){return"object"==typeof e?{object:e}:null}}const L=new i;L.bindToDOM(document.querySelector("#game-container"));const T=new class{constructor(e){this.storage=e}save(e){this.storage.setItem("state",JSON.stringify(e))}load(){try{return JSON.parse(this.storage.getItem("state"))}catch(e){throw new Error("Invalid state")}}}(localStorage),P=new class{constructor(e,t){this.gamePlay=e,this.stateService=t,this.gameState=new w,this.selectedCharacter=!1,this.indexOfSelectedCharacter=null,this.previouslySelected=null}init(){this.prepareBoard(),this.drawCharacters()}prepareBoard(){this.gamePlay.drawUi(Object.values(r)[this.gameState.level-1]),this.removeListeners(),this.addListeners(),this.showStats()}drawCharacters(){this.teamHuman=d((new y).teamHumanInit,1,2),this.teamComp=d((new y).teamComp,1,2),this.posTeamHuman=p(this.teamHuman,"human"),this.posTeamComp=p(this.teamComp,"comp"),this.gameState.positioned=[...this.posTeamHuman,...this.posTeamComp],this.gamePlay.redrawPositions(this.gameState.positioned)}onCellEnter(e){const t=this.findCharacterHere(e);if(t){const{level:a,attack:s,defence:i,health:r}=t.character;this.gamePlay.showCellTooltip(`ðŸŽ–${a} âš”${s} ðŸ›¡${i} â¤${r}`,e)}if(this.indexOfSelectedCharacter&&this.selectedCharacter){const s=this.findNumberOfStepsToMove(),i=this.findNumberOfStepsToAttack();if(s||i){const r=a(this.indexOfSelectedCharacter,e,s),o=a(this.indexOfSelectedCharacter,e,i);this.selectedCharacter&&(r&&!this.findCharacterHere(e)&&(this.gamePlay.selectCell(e,"green"),this.gamePlay.setCursor(h)),r||this.gamePlay.setCursor(l),"comp"===(null==t?void 0:t.character.team)&&o?(this.gamePlay.selectCell(e,"red"),this.gamePlay.setCursor(n)):"human"===(null==t?void 0:t.character.team)&&this.gamePlay.selectCell(e,""))}}}onCellLeave(e){this.gamePlay.hideCellTooltip(e),e!==this.indexOfSelectedCharacter&&(this.gamePlay.deselectCell(e),this.gamePlay.setCursor(h))}onCellClick(e){if(this.gameState.playersTurn){if(this.posTeamHuman.length>0&&this.gameState.level<=4&&0!==this.posTeamComp.length){const t=this.findCharacterHere(e);if(t){const{team:a}=t.character;"comp"!==a||this.selectedCharacter?(this.previouslySelected=this.selectedCharacter,this.selectedCharacter=t,this.gamePlay.deselectCell(this.indexOfSelectedCharacter||e),this.gamePlay.selectCell(e),this.indexOfSelectedCharacter=e,this.gamePlay.setCursor(h)):(i.showError("It is not your character. Choose yours"),this.gamePlay.deselectCell(this.indexOfSelectedCharacter||e))}else this.selectedCharacter||i.showError("There is no character here. Choose any cell with a character");if(this.previouslySelected&&t){const s=this.previouslySelected.character.attackDistance,r=a(this.previouslySelected.position,e,s),{team:h}=t.character;if("human"===h)this.gamePlay.deselectCell(this.indexOfSelectedCharacter),this.gamePlay.selectCell(e);else if(r){const a=t,s=Math.max(this.selectedCharacter.character.attack-a.character.defence,.1*this.selectedCharacter.character.attack);this.gamePlay.showDamage(e,s).then((()=>{a.character.health-=s;const e=this.posTeamComp.indexOf(a);a.character.health<=0&&(this.posTeamComp.splice(e,1),this.gameState.positioned=[...this.posTeamHuman,...this.posTeamComp],0===this.posTeamComp.length&&(this.gameState.playersTurn=!0,this.levelUp())),this.removeSelected(),this.gamePlay.redrawPositions(this.gameState.positioned),this.computersMove()})),this.selectedCharacter=null,this.indexOfSelectedCharacter=null,this.gameState.playersTurn=!1}else i.showError("It is too far to attack this character"),this.selectedCharacter=null,this.previouslySelected=null,this.removeSelected(),this.computersMove()}if(!t&&this.selectedCharacter){const t=this.findNumberOfStepsToMove();a(this.indexOfSelectedCharacter,e,t)?(this.posTeamHuman=[...this.posTeamHuman].filter((e=>e.position!==this.indexOfSelectedCharacter)),this.selectedCharacter.position=e,this.posTeamHuman.push(this.selectedCharacter),this.gameState.positioned=[...this.posTeamHuman,...this.posTeamComp],this.selectedCharacter=null,this.indexOfSelectedCharacter=null,this.gamePlay.redrawPositions(this.gameState.positioned),this.removeSelected(),this.gameState.playersTurn=!1):i.showError("It is not allowed to move there"),this.computersMove()}}}else i.showError("It is not your turn yet")}async computersMove(){if(this.gameState.playersTurn)this.gameState.playersTurn=!0;else{await s(300);const e=Math.floor(Math.random()*this.posTeamComp.length),a=this.posTeamComp[e],r=a.position,h=a.character.moveDistance,n=a.character.attackDistance,l=this.posTeamHuman.map((e=>e.position)),o=this.posTeamComp.map((e=>e.position)),c=t(r,h).filter((e=>-1===o.indexOf(e))).filter((e=>-1===l.indexOf(e))),m=t(r,n).filter((e=>l.indexOf(e)>-1));let d=null;if(1===m.length?d=m[0]:m.length>1&&(d=m[Math.floor(Math.random()*m.length)]),d){const e=this.findCharacterHere(d),t=Math.max(a.character.attack-e.character.defence,.1*a.character.attack);this.gamePlay.selectCell(a.position),await s(300),this.gamePlay.selectCell(d,"red");const r=this.gamePlay.showDamage(d,t);this.gamePlay.deselectCell(a.position),r.then((()=>{e.character.health-=t;const a=this.posTeamHuman.indexOf(e);e.character.health<=0&&(this.posTeamHuman.splice(a,1),this.gameState.positioned=[...this.posTeamHuman,...this.posTeamComp],0===this.posTeamHuman.length&&i.showMessage("You lost. Better luck next time")),this.gamePlay.redrawPositions(this.gameState.positioned),this.gamePlay.deselectCell(d)}))}else this.posTeamComp=[...this.posTeamComp].filter((e=>e.position!==r)),this.gamePlay.selectCell(a.position),await s(300),this.gamePlay.deselectCell(a.position),a.position=c[Math.floor(Math.random()*c.length)],this.gamePlay.selectCell(a.position,"green"),await s(300),this.gamePlay.deselectCell(a.position),this.posTeamComp.push(a),this.gameState.positioned=[...this.posTeamHuman,...this.posTeamComp],this.gamePlay.redrawPositions(this.gameState.positioned);this.gameState.playersTurn=!0}}levelUp(){this.gameState.level<=4&&(this.gameState.points+=this.posTeamHuman.map((e=>e.character.health)).reduce(((e,t)=>e+t)),this.gameState.highestPoints<this.gameState.points&&(this.gameState.highestPoints=this.gameState.points),this.showStats(),this.gameState.level<4?(this.gameState.level+=1,this.prepareBoard(),this.gameState.positioned.forEach((e=>e.character.levelUp())),this.teamHuman=this.posTeamHuman.map((e=>e.character)),this.teamHuman.push(m((new y).teamHuman,this.gameState.level-1).next().value),this.posTeamHuman=p(this.teamHuman,"human"),this.teamComp=d((new y).teamComp,this.gameState.level,this.posTeamHuman.length),this.posTeamComp=p(this.teamComp,"comp"),this.gameState.positioned=[...this.posTeamHuman,...this.posTeamComp],this.gamePlay.redrawPositions(this.gameState.positioned)):alert("Congrats! This was the last level"))}onNewGameClick(){this.deselect(),this.gameState.playersTurn=!0,this.gameState.level=1,this.gameState.points=0,this.init()}onSaveGameClick(){this.stateService.save(this.gameState),i.showMessage("Saved")}onLoadGame(){try{const e=this.stateService.load(),t={swordsman:v,bowman:u,magician:C,daemon:g,undead:f,vampire:S};this.deselect(),this.gameState.level=e.level,this.gameState.points=e.points,this.gameState.highestPoints=e.highestPoints,this.gameState.playersTurn=e.playersTurn,this.prepareBoard(),this.gameState.positioned=e.positioned.map((e=>{const{attack:a,attackDistance:s,defence:i,health:r,level:h,moveDistance:n,team:l,type:o}=e.character,m=new t[o](h);return m.attack=a,m.attackDistance=s,m.defence=i,m.health=r,m.moveDistance=n,m.team=l,new c(m,e.position)})),this.posTeamHuman=this.gameState.positioned.filter((e=>"human"===e.character.team)),this.posTeamComp=this.gameState.positioned.filter((e=>"comp"===e.character.team)),i.showMessage("Loaded")}catch(e){return void i.showError("Something went wrong")}this.gamePlay.redrawPositions(this.gameState.positioned)}addListeners(){this.gamePlay.addCellEnterListener(this.onCellEnter.bind(this)),this.gamePlay.addCellLeaveListener(this.onCellLeave.bind(this)),this.gamePlay.addCellClickListener(this.onCellClick.bind(this)),this.gamePlay.addNewGameListener(this.onNewGameClick.bind(this)),this.gamePlay.addSaveGameListener(this.onSaveGameClick.bind(this)),this.gamePlay.addLoadGameListener(this.onLoadGame.bind(this))}removeListeners(){this.gamePlay.cellClickListeners=[],this.gamePlay.cellEnterListeners=[],this.gamePlay.cellLeaveListeners=[],this.gamePlay.newGameListeners=[],this.gamePlay.saveGameListeners=[],this.gamePlay.loadGameListeners=[]}deselect(){this.removeListeners(),this.selectedCharacter=!1,this.indexOfSelectedCharacter=null,this.previouslySelected=null}showStats(){this.gamePlay.setCurrentLevel(this.gameState.level),this.gamePlay.setCurrentScore(this.gameState.points),this.gamePlay.setBestScore(this.gameState.highestPoints)}removeSelected(){this.gamePlay.cells.forEach((e=>e.classList.remove("selected-yellow","selected-green","selected-red")))}findCharacterHere(e){return this.gameState.positioned.find((t=>t.position===e))}findNumberOfStepsToMove(){return this.selectedCharacter.character.moveDistance}findNumberOfStepsToAttack(){return this.selectedCharacter.character.attackDistance}}(L,T);P.init()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TCxLQUFLak4sT0FDMURBLEtBQUt3SSxTQUFTOUUsb0JBQW9CMUQsS0FBSzJCLGdCQUFnQnNMLEtBQUtqTixPQUM1REEsS0FBS3dJLFNBQVM3RSxvQkFBb0IzRCxLQUFLc00sV0FBV1csS0FBS2pOLE9BR3pEZ0ssa0JBQ0VoSyxLQUFLd0ksU0FBU3BJLG1CQUFxQixHQUNuQ0osS0FBS3dJLFNBQVNuSSxtQkFBcUIsR0FDbkNMLEtBQUt3SSxTQUFTbEksbUJBQXFCLEdBQ25DTixLQUFLd0ksU0FBU2pJLGlCQUFtQixHQUNqQ1AsS0FBS3dJLFNBQVNoSSxrQkFBb0IsR0FDbENSLEtBQUt3SSxTQUFTL0gsa0JBQW9CLEdBR3BDNEwsV0FDRXJNLEtBQUtnSyxrQkFDTGhLLEtBQUt1SixtQkFBb0IsRUFDekJ2SixLQUFLd0oseUJBQTJCLEtBQ2hDeEosS0FBS3lKLG1CQUFxQixLQUc1QlMsWUFDRWxLLEtBQUt3SSxTQUFTcEQsZ0JBQWdCcEYsS0FBS3NKLFVBQVVqRSxPQUM3Q3JGLEtBQUt3SSxTQUFTbEQsZ0JBQWdCdEYsS0FBS3NKLFVBQVUvRCxRQUM3Q3ZGLEtBQUt3SSxTQUFTaEQsYUFBYXhGLEtBQUtzSixVQUFVN0QsZUFHNUMyRixpQkFDRXBMLEtBQUt3SSxTQUFTckksTUFBTTRELFNBQVNwQixHQUFTQSxFQUFLZCxVQUFVMEMsT0FBTyxrQkFBbUIsaUJBQWtCLGtCQUduRytGLGtCQUFrQnRNLEdBQ2hCLE9BQU9nQyxLQUFLc0osVUFBVWhCLFdBQVc0RSxNQUM5QnBLLEdBQWNBLEVBQVVGLFdBQWE1RSxJQUkxQ3dNLDBCQUNFLE9BQU94SyxLQUFLdUosa0JBQWtCekcsVUFBVXpFLGFBRzFDcU0sNEJBQ0UsT0FBTzFLLEtBQUt1SixrQkFBa0J6RyxVQUFVNEUsaUJGM2RSYyxFQUFVQyxHQUM5Q1ksRUFBU0ssUSIsInNvdXJjZXMiOlsid2VicGFjazovL2Fqcy1kaXBsb21hLy4vc3JjL2pzL3V0aWxzLmpzIiwid2VicGFjazovL2Fqcy1kaXBsb21hLy4vc3JjL2pzL0dhbWVQbGF5LmpzIiwid2VicGFjazovL2Fqcy1kaXBsb21hLy4vc3JjL2pzL3RoZW1lcy5qcyIsIndlYnBhY2s6Ly9hanMtZGlwbG9tYS8uL3NyYy9qcy9jdXJzb3JzLmpzIiwid2VicGFjazovL2Fqcy1kaXBsb21hLy4vc3JjL2pzL0NoYXJhY3Rlci5qcyIsIndlYnBhY2s6Ly9hanMtZGlwbG9tYS8uL3NyYy9qcy9Qb3NpdGlvbmVkQ2hhcmFjdGVyLmpzIiwid2VicGFjazovL2Fqcy1kaXBsb21hLy4vc3JjL2pzL2dlbmVyYXRvcnMuanMiLCJ3ZWJwYWNrOi8vYWpzLWRpcGxvbWEvLi9zcmMvanMvY2hhcmFjdGVycy9Cb3dtYW4uanMiLCJ3ZWJwYWNrOi8vYWpzLWRpcGxvbWEvLi9zcmMvanMvY2hhcmFjdGVycy9EYWVtb24uanMiLCJ3ZWJwYWNrOi8vYWpzLWRpcGxvbWEvLi9zcmMvanMvY2hhcmFjdGVycy9NYWdpY2lhbi5qcyIsIndlYnBhY2s6Ly9hanMtZGlwbG9tYS8uL3NyYy9qcy9jaGFyYWN0ZXJzL1N3b3Jkc21hbi5qcyIsIndlYnBhY2s6Ly9hanMtZGlwbG9tYS8uL3NyYy9qcy9jaGFyYWN0ZXJzL1VuZGVhZC5qcyIsIndlYnBhY2s6Ly9hanMtZGlwbG9tYS8uL3NyYy9qcy9jaGFyYWN0ZXJzL1ZhbXBpcmUuanMiLCJ3ZWJwYWNrOi8vYWpzLWRpcGxvbWEvLi9zcmMvanMvVGVhbS5qcyIsIndlYnBhY2s6Ly9hanMtZGlwbG9tYS8uL3NyYy9qcy9HYW1lU3RhdGUuanMiLCJ3ZWJwYWNrOi8vYWpzLWRpcGxvbWEvLi9zcmMvanMvYXBwLmpzIiwid2VicGFjazovL2Fqcy1kaXBsb21hLy4vc3JjL2pzL0dhbWVTdGF0ZVNlcnZpY2UuanMiLCJ3ZWJwYWNrOi8vYWpzLWRpcGxvbWEvLi9zcmMvanMvR2FtZUNvbnRyb2xsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGNhbGNUaWxlVHlwZShpbmRleCwgYm9hcmRTaXplKSB7XG4gIGNvbnN0IHNxdWFyZSA9IGJvYXJkU2l6ZSAqIGJvYXJkU2l6ZTtcbiAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgcmV0dXJuICd0b3AtbGVmdCc7XG4gIH1cbiAgaWYgKGluZGV4ID09PSBib2FyZFNpemUgLSAxKSB7XG4gICAgcmV0dXJuICd0b3AtcmlnaHQnO1xuICB9XG4gIGlmIChpbmRleCA9PT0gc3F1YXJlIC0gYm9hcmRTaXplKSB7XG4gICAgcmV0dXJuICdib3R0b20tbGVmdCc7XG4gIH1cbiAgaWYgKGluZGV4ID09PSBzcXVhcmUgLSAxKSB7XG4gICAgcmV0dXJuICdib3R0b20tcmlnaHQnO1xuICB9XG4gIGlmIChpbmRleCA+IDAgJiYgaW5kZXggPCBib2FyZFNpemUgLSAxKSB7XG4gICAgcmV0dXJuICd0b3AnO1xuICB9XG4gIGlmIChpbmRleCA8IHNxdWFyZSAtIDEgJiYgaW5kZXggPiBzcXVhcmUgLSBib2FyZFNpemUpIHtcbiAgICByZXR1cm4gJ2JvdHRvbSc7XG4gIH1cbiAgaWYgKGluZGV4ICUgYm9hcmRTaXplID09PSAwKSB7XG4gICAgcmV0dXJuICdsZWZ0JztcbiAgfVxuICBpZiAoaW5kZXggJSBib2FyZFNpemUgPT09IGJvYXJkU2l6ZSAtIDEpIHtcbiAgICByZXR1cm4gJ3JpZ2h0JztcbiAgfVxuXG4gIHJldHVybiAnY2VudGVyJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbGNIZWFsdGhMZXZlbChoZWFsdGgpIHtcbiAgaWYgKGhlYWx0aCA8IDE1KSB7XG4gICAgcmV0dXJuICdjcml0aWNhbCc7XG4gIH1cblxuICBpZiAoaGVhbHRoIDwgNTApIHtcbiAgICByZXR1cm4gJ25vcm1hbCc7XG4gIH1cblxuICByZXR1cm4gJ2hpZ2gnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY291bnRQb3NzaWJsZUluZGV4ZXMoXG4gIGN1cnJlbnRJbmRleCxcbiAgbW92ZURpc3RhbmNlLFxuICBib2FyZFNpemUgPSA4LFxuKSB7XG4gIGNvbnN0IHBvc3NpYmxlSW5kZXhlcyA9IFtdO1xuICBmdW5jdGlvbiBjb3VudFJvdyh2YXJpYWJsZSkge1xuICAgIHJldHVybiBNYXRoLmNlaWwoKHZhcmlhYmxlICsgMSkgLyBib2FyZFNpemUpO1xuICB9XG5cbiAgZm9yIChsZXQgaSA9IDE7IGkgPD0gbW92ZURpc3RhbmNlOyBpKyspIHtcbiAgICBjb25zdCB1cCA9IGN1cnJlbnRJbmRleCAtIGJvYXJkU2l6ZSAqIGk7XG4gICAgY29uc3QgZG93biA9IGN1cnJlbnRJbmRleCArIGJvYXJkU2l6ZSAqIGk7XG4gICAgY29uc3QgbGVmdCA9IGN1cnJlbnRJbmRleCAtIDEgKiBpO1xuICAgIGNvbnN0IHJpZ2h0ID0gY3VycmVudEluZGV4ICsgMSAqIGk7XG4gICAgY29uc3QgdXBSaWdodERpYWcgPSBjdXJyZW50SW5kZXggLSAoYm9hcmRTaXplIC0gMSkgKiBpO1xuICAgIGNvbnN0IHVwTGVmdERpYWcgPSBjdXJyZW50SW5kZXggLSAoYm9hcmRTaXplICsgMSkgKiBpO1xuICAgIGNvbnN0IGRvd25SaWdodERpYWcgPSBjdXJyZW50SW5kZXggKyAoYm9hcmRTaXplICsgMSkgKiBpO1xuICAgIGNvbnN0IGRvd25MZWZ0RGlhZyA9IGN1cnJlbnRJbmRleCArIChib2FyZFNpemUgLSAxKSAqIGk7XG5cbiAgICBjb25zdCBjdXJyZW50SW5kZXhSb3cgPSBjb3VudFJvdyhjdXJyZW50SW5kZXgpO1xuXG4gICAgaWYgKHVwID49IDApIHtcbiAgICAgIHBvc3NpYmxlSW5kZXhlcy5wdXNoKHVwKTtcbiAgICB9XG4gICAgaWYgKGRvd24gPD0gYm9hcmRTaXplICoqIDIgLSAxKSB7XG4gICAgICBwb3NzaWJsZUluZGV4ZXMucHVzaChkb3duKTtcbiAgICB9XG4gICAgaWYgKGN1cnJlbnRJbmRleFJvdyA9PT0gY291bnRSb3cobGVmdCkpIHtcbiAgICAgIHBvc3NpYmxlSW5kZXhlcy5wdXNoKGxlZnQpO1xuICAgIH1cbiAgICBpZiAoY3VycmVudEluZGV4Um93ID09PSBjb3VudFJvdyhyaWdodCkpIHtcbiAgICAgIHBvc3NpYmxlSW5kZXhlcy5wdXNoKHJpZ2h0KTtcbiAgICB9XG4gICAgaWYgKHVwUmlnaHREaWFnID4gMCAmJiBjdXJyZW50SW5kZXhSb3cgLSBpID09PSBjb3VudFJvdyh1cFJpZ2h0RGlhZykpIHtcbiAgICAgIHBvc3NpYmxlSW5kZXhlcy5wdXNoKHVwUmlnaHREaWFnKTtcbiAgICB9XG4gICAgaWYgKHVwTGVmdERpYWcgPj0gMCAmJiBjdXJyZW50SW5kZXhSb3cgLSBpID09PSBjb3VudFJvdyh1cExlZnREaWFnKSkge1xuICAgICAgcG9zc2libGVJbmRleGVzLnB1c2godXBMZWZ0RGlhZyk7XG4gICAgfVxuICAgIGlmIChcbiAgICAgIGRvd25SaWdodERpYWcgPD0gYm9hcmRTaXplICoqIDIgLSAxXG4gICAgICAmJiBjdXJyZW50SW5kZXhSb3cgKyBpID09PSBjb3VudFJvdyhkb3duUmlnaHREaWFnKVxuICAgICkge1xuICAgICAgcG9zc2libGVJbmRleGVzLnB1c2goZG93blJpZ2h0RGlhZyk7XG4gICAgfVxuICAgIGlmIChcbiAgICAgIGRvd25MZWZ0RGlhZyA8IGJvYXJkU2l6ZSAqKiAyIC0gMVxuICAgICAgJiYgY3VycmVudEluZGV4Um93ICsgaSA9PT0gY291bnRSb3coZG93bkxlZnREaWFnKVxuICAgICkge1xuICAgICAgcG9zc2libGVJbmRleGVzLnB1c2goZG93bkxlZnREaWFnKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBvc3NpYmxlSW5kZXhlcztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBvc3NpYmxlTW92ZShjdXJyZW50SW5kZXgsIGZ1dHVyZUluZGV4LCBtb3ZlRGlzdGFuY2UpIHtcbiAgY29uc3QgY291bnRlZFBvc3NpYmxlSW5kZXhlcyA9IGNvdW50UG9zc2libGVJbmRleGVzKFxuICAgIGN1cnJlbnRJbmRleCxcbiAgICBtb3ZlRGlzdGFuY2UsXG4gICk7XG5cbiAgcmV0dXJuIGNvdW50ZWRQb3NzaWJsZUluZGV4ZXMuaW5jbHVkZXMoZnV0dXJlSW5kZXgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0VGltZXIodGltZSkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHJlc29sdmUodHJ1ZSk7XG4gICAgfSwgdGltZSk7XG4gIH0pO1xufVxuIiwiaW1wb3J0IHsgY2FsY0hlYWx0aExldmVsLCBjYWxjVGlsZVR5cGUgfSBmcm9tICcuL3V0aWxzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZVBsYXkge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmJvYXJkU2l6ZSA9IDg7XG4gICAgdGhpcy5jb250YWluZXIgPSBudWxsO1xuICAgIHRoaXMuYm9hcmRFbCA9IG51bGw7XG4gICAgdGhpcy5jZWxscyA9IFtdO1xuICAgIHRoaXMuY2VsbENsaWNrTGlzdGVuZXJzID0gW107XG4gICAgdGhpcy5jZWxsRW50ZXJMaXN0ZW5lcnMgPSBbXTtcbiAgICB0aGlzLmNlbGxMZWF2ZUxpc3RlbmVycyA9IFtdO1xuICAgIHRoaXMubmV3R2FtZUxpc3RlbmVycyA9IFtdO1xuICAgIHRoaXMuc2F2ZUdhbWVMaXN0ZW5lcnMgPSBbXTtcbiAgICB0aGlzLmxvYWRHYW1lTGlzdGVuZXJzID0gW107XG4gIH1cblxuICBiaW5kVG9ET00oY29udGFpbmVyKSB7XG4gICAgaWYgKCEoY29udGFpbmVyIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvbnRhaW5lciBpcyBub3QgSFRNTEVsZW1lbnQnKTtcbiAgICB9XG4gICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG4gIH1cblxuICAvKipcbiAgICogRHJhd3MgYm9hcmRFbCB3aXRoIHNwZWNpZmljIHRoZW1lXG4gICAqXG4gICAqIEBwYXJhbSB0aGVtZVxuICAgKi9cbiAgZHJhd1VpKHRoZW1lKSB7XG4gICAgdGhpcy5jaGVja0JpbmRpbmcoKTtcblxuICAgIHRoaXMuY29udGFpbmVyLmlubmVySFRNTCA9IGBcbiAgICAgIDxkaXYgY2xhc3M9XCJjb250cm9sc1wiPlxuICAgICAgICA8YnV0dG9uIGRhdGEtaWQ9XCJhY3Rpb24tcmVzdGFydFwiIGNsYXNzPVwiYnRuXCI+TmV3IEdhbWU8L2J1dHRvbj5cbiAgICAgICAgPGJ1dHRvbiBkYXRhLWlkPVwiYWN0aW9uLXNhdmVcIiBjbGFzcz1cImJ0blwiPlNhdmUgR2FtZTwvYnV0dG9uPlxuICAgICAgICA8YnV0dG9uIGRhdGEtaWQ9XCJhY3Rpb24tbG9hZFwiIGNsYXNzPVwiYnRuXCI+TG9hZCBHYW1lPC9idXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJnYW1lLWluZm9cIj5cbiAgICAgICAgPHNwYW4gZGF0YS1pZD1cImN1cnJlbnQtbGV2ZWxcIj5DdXJyZW50IGxldmVsOiAxPC9zcGFuPlxuICAgICAgICA8c3BhbiBkYXRhLWlkPVwiY3VycmVudC1zY29yZVwiPkN1cnJlbnQgU2NvcmU6IDA8L3NwYW4+XG4gICAgICAgIDxzcGFuIGRhdGEtaWQ9XCJiZXN0LXNjb3JlXCI+QmVzdCBTY29yZTogMDwvc3Bhbj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cImJvYXJkLWNvbnRhaW5lclwiPlxuICAgICAgICA8ZGl2IGRhdGEtaWQ9XCJib2FyZFwiIGNsYXNzPVwiYm9hcmRcIj48L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIGA7XG5cbiAgICB0aGlzLm5ld0dhbWVFbCA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWlkPWFjdGlvbi1yZXN0YXJ0XScpO1xuICAgIHRoaXMuc2F2ZUdhbWVFbCA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWlkPWFjdGlvbi1zYXZlXScpO1xuICAgIHRoaXMubG9hZEdhbWVFbCA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWlkPWFjdGlvbi1sb2FkXScpO1xuXG4gICAgdGhpcy5jdXJyZW50TGV2ZWwgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdbZGF0YS1pZD1jdXJyZW50LWxldmVsXScpO1xuICAgIHRoaXMuY3VycmVudFNjb3JlID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignW2RhdGEtaWQ9Y3VycmVudC1zY29yZV0nKTtcbiAgICB0aGlzLmJlc3RTY29yZSA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWlkPWJlc3Qtc2NvcmVdJyk7XG5cbiAgICB0aGlzLm5ld0dhbWVFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4gdGhpcy5vbk5ld0dhbWVDbGljayhldmVudCkpO1xuICAgIHRoaXMuc2F2ZUdhbWVFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4gdGhpcy5vblNhdmVHYW1lQ2xpY2soZXZlbnQpKTtcbiAgICB0aGlzLmxvYWRHYW1lRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHRoaXMub25Mb2FkR2FtZUNsaWNrKGV2ZW50KSk7XG5cbiAgICB0aGlzLmJvYXJkRWwgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdbZGF0YS1pZD1ib2FyZF0nKTtcblxuICAgIHRoaXMuYm9hcmRFbC5jbGFzc0xpc3QuYWRkKHRoZW1lKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYm9hcmRTaXplICoqIDI7IGkgKz0gMSkge1xuICAgICAgY29uc3QgY2VsbEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBjZWxsRWwuY2xhc3NMaXN0LmFkZChcbiAgICAgICAgJ2NlbGwnLFxuICAgICAgICAnbWFwLXRpbGUnLFxuICAgICAgICBgbWFwLXRpbGUtJHtjYWxjVGlsZVR5cGUoaSwgdGhpcy5ib2FyZFNpemUpfWAsXG4gICAgICApO1xuICAgICAgY2VsbEVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoZXZlbnQpID0+IHRoaXMub25DZWxsRW50ZXIoZXZlbnQpKTtcbiAgICAgIGNlbGxFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKGV2ZW50KSA9PiB0aGlzLm9uQ2VsbExlYXZlKGV2ZW50KSk7XG4gICAgICBjZWxsRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHRoaXMub25DZWxsQ2xpY2soZXZlbnQpKTtcbiAgICAgIHRoaXMuYm9hcmRFbC5hcHBlbmRDaGlsZChjZWxsRWwpO1xuICAgIH1cblxuICAgIHRoaXMuY2VsbHMgPSBBcnJheS5mcm9tKHRoaXMuYm9hcmRFbC5jaGlsZHJlbik7XG4gIH1cblxuICAvKipcbiAgICogRHJhd3MgcG9zaXRpb25zICh3aXRoIGNoYXJzKSBvbiBib2FyZEVsXG4gICAqXG4gICAqIEBwYXJhbSBwb3NpdGlvbnMgYXJyYXkgb2YgUG9zaXRpb25lZENoYXJhY3RlciBvYmplY3RzXG4gICAqL1xuICByZWRyYXdQb3NpdGlvbnMocG9zaXRpb25zKSB7XG4gICAgZm9yIChjb25zdCBjZWxsIG9mIHRoaXMuY2VsbHMpIHtcbiAgICAgIGNlbGwuaW5uZXJIVE1MID0gJyc7XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBwb3NpdGlvbiBvZiBwb3NpdGlvbnMpIHtcbiAgICAgIGNvbnN0IGNlbGxFbCA9IHRoaXMuYm9hcmRFbC5jaGlsZHJlbltwb3NpdGlvbi5wb3NpdGlvbl07XG4gICAgICBjb25zdCBjaGFyRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIGNoYXJFbC5jbGFzc0xpc3QuYWRkKCdjaGFyYWN0ZXInLCBwb3NpdGlvbi5jaGFyYWN0ZXIudHlwZSk7XG5cbiAgICAgIGNvbnN0IGhlYWx0aEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBoZWFsdGhFbC5jbGFzc0xpc3QuYWRkKCdoZWFsdGgtbGV2ZWwnKTtcblxuICAgICAgY29uc3QgaGVhbHRoSW5kaWNhdG9yRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIGhlYWx0aEluZGljYXRvckVsLmNsYXNzTGlzdC5hZGQoXG4gICAgICAgICdoZWFsdGgtbGV2ZWwtaW5kaWNhdG9yJyxcbiAgICAgICAgYGhlYWx0aC1sZXZlbC1pbmRpY2F0b3ItJHtjYWxjSGVhbHRoTGV2ZWwocG9zaXRpb24uY2hhcmFjdGVyLmhlYWx0aCl9YCxcbiAgICAgICk7XG4gICAgICBoZWFsdGhJbmRpY2F0b3JFbC5zdHlsZS53aWR0aCA9IGAke3Bvc2l0aW9uLmNoYXJhY3Rlci5oZWFsdGh9JWA7XG4gICAgICBoZWFsdGhFbC5hcHBlbmRDaGlsZChoZWFsdGhJbmRpY2F0b3JFbCk7XG5cbiAgICAgIGNoYXJFbC5hcHBlbmRDaGlsZChoZWFsdGhFbCk7XG4gICAgICBjZWxsRWwuYXBwZW5kQ2hpbGQoY2hhckVsKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWRkIGxpc3RlbmVyIHRvIG1vdXNlIGVudGVyIGZvciBjZWxsXG4gICAqXG4gICAqIEBwYXJhbSBjYWxsYmFja1xuICAgKi9cbiAgYWRkQ2VsbEVudGVyTGlzdGVuZXIoY2FsbGJhY2spIHtcbiAgICB0aGlzLmNlbGxFbnRlckxpc3RlbmVycy5wdXNoKGNhbGxiYWNrKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgbGlzdGVuZXIgdG8gbW91c2UgbGVhdmUgZm9yIGNlbGxcbiAgICpcbiAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAqL1xuICBhZGRDZWxsTGVhdmVMaXN0ZW5lcihjYWxsYmFjaykge1xuICAgIHRoaXMuY2VsbExlYXZlTGlzdGVuZXJzLnB1c2goY2FsbGJhY2spO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBsaXN0ZW5lciB0byBtb3VzZSBjbGljayBmb3IgY2VsbFxuICAgKlxuICAgKiBAcGFyYW0gY2FsbGJhY2tcbiAgICovXG4gIGFkZENlbGxDbGlja0xpc3RlbmVyKGNhbGxiYWNrKSB7XG4gICAgdGhpcy5jZWxsQ2xpY2tMaXN0ZW5lcnMucHVzaChjYWxsYmFjayk7XG4gIH1cblxuICAvKipcbiAgICogQWRkIGxpc3RlbmVyIHRvIFwiTmV3IEdhbWVcIiBidXR0b24gY2xpY2tcbiAgICpcbiAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAqL1xuICBhZGROZXdHYW1lTGlzdGVuZXIoY2FsbGJhY2spIHtcbiAgICB0aGlzLm5ld0dhbWVMaXN0ZW5lcnMucHVzaChjYWxsYmFjayk7XG4gIH1cblxuICAvKipcbiAgICogQWRkIGxpc3RlbmVyIHRvIFwiU2F2ZSBHYW1lXCIgYnV0dG9uIGNsaWNrXG4gICAqXG4gICAqIEBwYXJhbSBjYWxsYmFja1xuICAgKi9cbiAgYWRkU2F2ZUdhbWVMaXN0ZW5lcihjYWxsYmFjaykge1xuICAgIHRoaXMuc2F2ZUdhbWVMaXN0ZW5lcnMucHVzaChjYWxsYmFjayk7XG4gIH1cblxuICAvKipcbiAgICogQWRkIGxpc3RlbmVyIHRvIFwiTG9hZCBHYW1lXCIgYnV0dG9uIGNsaWNrXG4gICAqXG4gICAqIEBwYXJhbSBjYWxsYmFja1xuICAgKi9cbiAgYWRkTG9hZEdhbWVMaXN0ZW5lcihjYWxsYmFjaykge1xuICAgIHRoaXMubG9hZEdhbWVMaXN0ZW5lcnMucHVzaChjYWxsYmFjayk7XG4gIH1cblxuICBvbkNlbGxFbnRlcihldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgaW5kZXggPSB0aGlzLmNlbGxzLmluZGV4T2YoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgdGhpcy5jZWxsRW50ZXJMaXN0ZW5lcnMuZm9yRWFjaCgobykgPT4gby5jYWxsKG51bGwsIGluZGV4KSk7XG4gIH1cblxuICBvbkNlbGxMZWF2ZShldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgaW5kZXggPSB0aGlzLmNlbGxzLmluZGV4T2YoZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgdGhpcy5jZWxsTGVhdmVMaXN0ZW5lcnMuZm9yRWFjaCgobykgPT4gby5jYWxsKG51bGwsIGluZGV4KSk7XG4gIH1cblxuICBvbkNlbGxDbGljayhldmVudCkge1xuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5jZWxscy5pbmRleE9mKGV2ZW50LmN1cnJlbnRUYXJnZXQpO1xuICAgIHRoaXMuY2VsbENsaWNrTGlzdGVuZXJzLmZvckVhY2goKG8pID0+IG8uY2FsbChudWxsLCBpbmRleCkpO1xuICB9XG5cbiAgb25OZXdHYW1lQ2xpY2soZXZlbnQpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMubmV3R2FtZUxpc3RlbmVycy5mb3JFYWNoKChvKSA9PiBvLmNhbGwobnVsbCkpO1xuICB9XG5cbiAgb25TYXZlR2FtZUNsaWNrKGV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLnNhdmVHYW1lTGlzdGVuZXJzLmZvckVhY2goKG8pID0+IG8uY2FsbChudWxsKSk7XG4gIH1cblxuICBvbkxvYWRHYW1lQ2xpY2soZXZlbnQpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMubG9hZEdhbWVMaXN0ZW5lcnMuZm9yRWFjaCgobykgPT4gby5jYWxsKG51bGwpKTtcbiAgfVxuXG4gIHN0YXRpYyBzaG93RXJyb3IobWVzc2FnZSkge1xuICAgIGFsZXJ0KG1lc3NhZ2UpO1xuICB9XG5cbiAgc3RhdGljIHNob3dNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICBhbGVydChtZXNzYWdlKTtcbiAgfVxuXG4gIHNlbGVjdENlbGwoaW5kZXgsIGNvbG9yID0gJ3llbGxvdycpIHtcbiAgICB0aGlzLmRlc2VsZWN0Q2VsbChpbmRleCk7XG4gICAgdGhpcy5jZWxsc1tpbmRleF0uY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnLCBgc2VsZWN0ZWQtJHtjb2xvcn1gKTtcbiAgfVxuXG4gIGRlc2VsZWN0Q2VsbChpbmRleCkge1xuICAgIGNvbnN0IGNlbGwgPSB0aGlzLmNlbGxzW2luZGV4XTtcbiAgICBjZWxsLmNsYXNzTGlzdC5yZW1vdmUoXG4gICAgICAuLi5BcnJheS5mcm9tKGNlbGwuY2xhc3NMaXN0KS5maWx0ZXIoKG8pID0+IG8uc3RhcnRzV2l0aCgnc2VsZWN0ZWQnKSksXG4gICAgKTtcbiAgfVxuXG4gIHNob3dDZWxsVG9vbHRpcChtZXNzYWdlLCBpbmRleCkge1xuICAgIHRoaXMuY2VsbHNbaW5kZXhdLnRpdGxlID0gbWVzc2FnZTtcbiAgfVxuXG4gIGhpZGVDZWxsVG9vbHRpcChpbmRleCkge1xuICAgIHRoaXMuY2VsbHNbaW5kZXhdLnRpdGxlID0gJyc7XG4gIH1cblxuICBzaG93RGFtYWdlKGluZGV4LCBkYW1hZ2UpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgIGNvbnN0IGNlbGwgPSB0aGlzLmNlbGxzW2luZGV4XTtcbiAgICAgIGNvbnN0IGRhbWFnZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgZGFtYWdlRWwudGV4dENvbnRlbnQgPSBkYW1hZ2U7XG4gICAgICBkYW1hZ2VFbC5jbGFzc0xpc3QuYWRkKCdkYW1hZ2UnKTtcbiAgICAgIGNlbGwuYXBwZW5kQ2hpbGQoZGFtYWdlRWwpO1xuXG4gICAgICBkYW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKCdhbmltYXRpb25lbmQnLCAoKSA9PiB7XG4gICAgICAgIGNlbGwucmVtb3ZlQ2hpbGQoZGFtYWdlRWwpO1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHNldEN1cnNvcihjdXJzb3IpIHtcbiAgICB0aGlzLmJvYXJkRWwuc3R5bGUuY3Vyc29yID0gY3Vyc29yO1xuICB9XG5cbiAgY2hlY2tCaW5kaW5nKCkge1xuICAgIGlmICh0aGlzLmNvbnRhaW5lciA9PT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdHYW1lUGxheSBub3QgYmluZCB0byBET00nKTtcbiAgICB9XG4gIH1cblxuICBzZXRDdXJyZW50TGV2ZWwobGV2ZWwpIHtcbiAgICB0aGlzLmN1cnJlbnRMZXZlbC5pbm5lckhUTUwgPSBgQ3VycmVudCBMZXZlbDogJHtsZXZlbH1gO1xuICB9XG5cbiAgc2V0Q3VycmVudFNjb3JlKHBvaW50cykge1xuICAgIHRoaXMuY3VycmVudFNjb3JlLmlubmVySFRNTCA9IGBDdXJyZW50IFNjb3JlOiAke3BvaW50c31gO1xuICB9XG5cbiAgc2V0QmVzdFNjb3JlKGhpZ2hlc3RQb2ludHMpIHtcbiAgICB0aGlzLmJlc3RTY29yZS5pbm5lckhUTUwgPSBgQmVzdCBTY29yZTogJHtoaWdoZXN0UG9pbnRzfWA7XG4gIH1cbn1cbiIsImNvbnN0IHRoZW1lcyA9IHtcbiAgcHJhaXJpZTogJ3ByYWlyaWUnLFxuICBkZXNlcnQ6ICdkZXNlcnQnLFxuICBhcmN0aWM6ICdhcmN0aWMnLFxuICBtb3VudGFpbjogJ21vdW50YWluJyxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHRoZW1lcztcbiIsImNvbnN0IGN1cnNvcnMgPSB7XG4gIGF1dG86ICdhdXRvJyxcbiAgcG9pbnRlcjogJ3BvaW50ZXInLFxuICBjcm9zc2hhaXI6ICdjcm9zc2hhaXInLFxuICBub3RhbGxvd2VkOiAnbm90LWFsbG93ZWQnLFxufTtcblxuZXhwb3J0IGRlZmF1bHQgY3Vyc29ycztcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENoYXJhY3RlciB7XG4gIGNvbnN0cnVjdG9yKGxldmVsLCB0eXBlID0gJ2dlbmVyaWMnKSB7XG4gICAgdGhpcy5sZXZlbCA9IGxldmVsO1xuICAgIHRoaXMuYXR0YWNrID0gMDtcbiAgICB0aGlzLmRlZmVuY2UgPSAwO1xuICAgIHRoaXMuaGVhbHRoID0gNTA7XG4gICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICBpZiAobmV3LnRhcmdldC5uYW1lID09PSAnQ2hhcmFjdGVyJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBcIkl0J3Mgbm90IGFsbG93ZWQgdG8gY3JlYXRlIG5ldyBpbnN0YW5jZXMgb2YgQ2hhcmFjdGVycyB1c2luZyAnbmV3IENoYXJhY3RlcicuIFBsZWFzZSB1c2UgY2xhc3NlcyB0aGF0IGV4dGVuZCBjbGFzcyBDaGFyYWN0ZXIgaW5zdGVhZCAoQm93bWFuLCBEYWVtb24sIGV0Yy4pXCIsXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIGxldmVsVXAoKSB7XG4gICAgaWYgKHRoaXMuaGVhbHRoID4gMCkge1xuICAgICAgdGhpcy5sZXZlbCArPSAxO1xuICAgICAgdGhpcy5hdHRhY2sgPSBNYXRoLm1heChcbiAgICAgICAgdGhpcy5hdHRhY2ssXG4gICAgICAgIE1hdGgucm91bmQodGhpcy5hdHRhY2sgKiAoMC44ICsgdGhpcy5oZWFsdGggLyAxMDApKSxcbiAgICAgICk7XG4gICAgICB0aGlzLmRlZmVuY2UgPSBNYXRoLm1heChcbiAgICAgICAgdGhpcy5kZWZlbmNlLFxuICAgICAgICBNYXRoLnJvdW5kKHRoaXMuZGVmZW5jZSAqICgwLjggKyB0aGlzLmhlYWx0aCAvIDEwMCkpLFxuICAgICAgKTtcbiAgICAgIHRoaXMuaGVhbHRoIDwgMjAgPyAodGhpcy5oZWFsdGggKz0gODApIDogKHRoaXMuaGVhbHRoID0gMTAwKTtcbiAgICAgIC8vIH0gZWxzZSB7XG4gICAgICAvLyAgIHRocm93IG5ldyBFcnJvcihcIllvdSBjYW5ub3QgbGV2ZWwgdXAgYSBkZWFkIGNoYXJhY3RlclwiKTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCBDaGFyYWN0ZXIgZnJvbSAnLi9DaGFyYWN0ZXInO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3NpdGlvbmVkQ2hhcmFjdGVyIHtcbiAgY29uc3RydWN0b3IoY2hhcmFjdGVyLCBwb3NpdGlvbikge1xuICAgIGlmICghKGNoYXJhY3RlciBpbnN0YW5jZW9mIENoYXJhY3RlcikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgJ2NoYXJhY3RlciBtdXN0IGJlIGluc3RhbmNlIG9mIENoYXJhY3RlciBvciBpdHMgY2hpbGRyZW4nLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHBvc2l0aW9uICE9PSAnbnVtYmVyJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdwb3NpdGlvbiBtdXN0IGJlIGEgbnVtYmVyJyk7XG4gICAgfVxuXG4gICAgdGhpcy5jaGFyYWN0ZXIgPSBjaGFyYWN0ZXI7XG4gICAgdGhpcy5wb3NpdGlvbiA9IHBvc2l0aW9uO1xuICB9XG5cbiAgbGV2ZWxVcCgpIHtcbiAgICBpZiAodGhpcy5oZWFsdGggPiAwKSB7XG4gICAgICB0aGlzLmxldmVsICs9IDE7XG4gICAgICB0aGlzLmF0dGFjayA9IE1hdGgubWF4KFxuICAgICAgICB0aGlzLmF0dGFjayxcbiAgICAgICAgTWF0aC5yb3VuZCh0aGlzLmF0dGFjayAqICgwLjggKyB0aGlzLmhlYWx0aCAvIDEwMCkpLFxuICAgICAgKTtcbiAgICAgIHRoaXMuZGVmZW5jZSA9IE1hdGgubWF4KFxuICAgICAgICB0aGlzLmRlZmVuY2UsXG4gICAgICAgIE1hdGgucm91bmQodGhpcy5kZWZlbmNlICogKDAuOCArIHRoaXMuaGVhbHRoIC8gMTAwKSksXG4gICAgICApO1xuICAgICAgdGhpcy5oZWFsdGggPCAyMCA/ICh0aGlzLmhlYWx0aCArPSA4MCkgOiAodGhpcy5oZWFsdGggPSAxMDApO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IFBvc2l0aW9uZWRDaGFyYWN0ZXIgZnJvbSAnLi9Qb3NpdGlvbmVkQ2hhcmFjdGVyJztcblxuLyoqXG4gKiBHZW5lcmF0ZXMgcmFuZG9tIGNoYXJhY3RlcnNcbiAqXG4gKiBAcGFyYW0gYWxsb3dlZFR5cGVzIGl0ZXJhYmxlIG9mIGNsYXNzZXNcbiAqIEBwYXJhbSBtYXhMZXZlbCBtYXggY2hhcmFjdGVyIGxldmVsXG4gKiBAcmV0dXJucyBDaGFyYWN0ZXIgdHlwZSBjaGlsZHJlbiAoZXguIE1hZ2ljaWFuLCBCb3dtYW4sIGV0YylcbiAqL1xuXG5leHBvcnQgZnVuY3Rpb24qIGNoYXJhY3RlckdlbmVyYXRvcihhbGxvd2VkVHlwZXMsIG1heExldmVsKSB7XG4gIGNvbnN0IHR5cGUgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBhbGxvd2VkVHlwZXMubGVuZ3RoKTtcbiAgY29uc3QgbGV2ZWwgPSBNYXRoLmZsb29yKDEgKyBNYXRoLnJhbmRvbSgpICogbWF4TGV2ZWwpO1xuICB5aWVsZCBuZXcgYWxsb3dlZFR5cGVzW3R5cGVdKGxldmVsKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlVGVhbShhbGxvd2VkVHlwZXMsIG1heExldmVsLCBjaGFyYWN0ZXJDb3VudCkge1xuICBjb25zdCB0ZWFtID0gW107XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGFyYWN0ZXJDb3VudDsgaSsrKSB7XG4gICAgdGVhbS5wdXNoKGNoYXJhY3RlckdlbmVyYXRvcihhbGxvd2VkVHlwZXMsIG1heExldmVsKS5uZXh0KCkudmFsdWUpO1xuICB9XG5cbiAgcmV0dXJuIHRlYW07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVBvc2l0aW9uKHRlYW0sIHNpZGUsIGJvYXJkU2l6ZSA9IDgpIHtcbiAgY29uc3QgYWxsQ2VsbHMgPSBbLi4uQXJyYXkoYm9hcmRTaXplICoqIDIpLmtleXMoKV07XG4gIGxldCBwb3NzaWJsZUNlbGxzID0gbnVsbDtcblxuICBpZiAoc2lkZSA9PT0gJ2h1bWFuJykge1xuICAgIHBvc3NpYmxlQ2VsbHMgPSBhbGxDZWxscy5maWx0ZXIoXG4gICAgICAoY2VsbCkgPT4gY2VsbCAlIGJvYXJkU2l6ZSA9PT0gMCB8fCBjZWxsICUgYm9hcmRTaXplID09PSAxLFxuICAgICk7XG4gIH0gZWxzZSBpZiAoc2lkZSA9PT0gJ2NvbXAnKSB7XG4gICAgcG9zc2libGVDZWxscyA9IGFsbENlbGxzLmZpbHRlcihcbiAgICAgIChjZWxsKSA9PiBjZWxsICUgYm9hcmRTaXplID09PSA2IHx8IGNlbGwgJSBib2FyZFNpemUgPT09IDcsXG4gICAgKTtcbiAgfVxuXG4gIGNvbnN0IHBvc2l0aW9uZWRDaGFyYWN0ZXJzID0gW107XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB0ZWFtLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgaW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwb3NzaWJsZUNlbGxzLmxlbmd0aCk7XG4gICAgY29uc3QgcG9zaXRpb24gPSBwb3NzaWJsZUNlbGxzW2luZGV4XTtcblxuICAgIHBvc3NpYmxlQ2VsbHMuc3BsaWNlKGluZGV4LCAxKTtcblxuICAgIHBvc2l0aW9uZWRDaGFyYWN0ZXJzLnB1c2gobmV3IFBvc2l0aW9uZWRDaGFyYWN0ZXIodGVhbVtpXSwgcG9zaXRpb24pKTtcbiAgfVxuXG4gIHJldHVybiBwb3NpdGlvbmVkQ2hhcmFjdGVycztcbn1cbiIsImltcG9ydCBDaGFyYWN0ZXIgZnJvbSAnLi4vQ2hhcmFjdGVyJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQm93bWFuIGV4dGVuZHMgQ2hhcmFjdGVyIHtcbiAgY29uc3RydWN0b3IobGV2ZWwpIHtcbiAgICBzdXBlcihsZXZlbCwgJ2Jvd21hbicpO1xuICAgIHRoaXMuYXR0YWNrID0gMjU7XG4gICAgdGhpcy5kZWZlbmNlID0gMjU7XG4gICAgdGhpcy5hdHRhY2tEaXN0YW5jZSA9IDI7XG4gICAgdGhpcy5tb3ZlRGlzdGFuY2UgPSAyO1xuICAgIHRoaXMudGVhbSA9ICdodW1hbic7XG4gIH1cbn1cbiIsImltcG9ydCBDaGFyYWN0ZXIgZnJvbSAnLi4vQ2hhcmFjdGVyJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGFlbW9uIGV4dGVuZHMgQ2hhcmFjdGVyIHtcbiAgY29uc3RydWN0b3IobGV2ZWwpIHtcbiAgICBzdXBlcihsZXZlbCwgJ2RhZW1vbicpO1xuICAgIHRoaXMuYXR0YWNrID0gMTA7XG4gICAgdGhpcy5kZWZlbmNlID0gNDA7XG4gICAgdGhpcy5hdHRhY2tEaXN0YW5jZSA9IDQ7XG4gICAgdGhpcy5tb3ZlRGlzdGFuY2UgPSAxO1xuICAgIHRoaXMudGVhbSA9ICdjb21wJztcbiAgfVxufVxuIiwiaW1wb3J0IENoYXJhY3RlciBmcm9tICcuLi9DaGFyYWN0ZXInO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNYWdpY2lhbiBleHRlbmRzIENoYXJhY3RlciB7XG4gIGNvbnN0cnVjdG9yKGxldmVsKSB7XG4gICAgc3VwZXIobGV2ZWwsICdtYWdpY2lhbicpO1xuICAgIHRoaXMuYXR0YWNrID0gMTA7XG4gICAgdGhpcy5kZWZlbmNlID0gNDA7XG4gICAgdGhpcy5hdHRhY2tEaXN0YW5jZSA9IDQ7XG4gICAgdGhpcy5tb3ZlRGlzdGFuY2UgPSAxO1xuICAgIHRoaXMudGVhbSA9ICdodW1hbic7XG4gIH1cbn1cbiIsImltcG9ydCBDaGFyYWN0ZXIgZnJvbSAnLi4vQ2hhcmFjdGVyJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3dvcmRzbWFuIGV4dGVuZHMgQ2hhcmFjdGVyIHtcbiAgY29uc3RydWN0b3IobGV2ZWwpIHtcbiAgICBzdXBlcihsZXZlbCwgJ3N3b3Jkc21hbicpO1xuICAgIHRoaXMuYXR0YWNrID0gNDA7XG4gICAgdGhpcy5kZWZlbmNlID0gMTA7XG4gICAgdGhpcy5hdHRhY2tEaXN0YW5jZSA9IDE7XG4gICAgdGhpcy5tb3ZlRGlzdGFuY2UgPSA0O1xuICAgIHRoaXMudGVhbSA9ICdodW1hbic7XG4gIH1cbn1cbiIsImltcG9ydCBDaGFyYWN0ZXIgZnJvbSAnLi4vQ2hhcmFjdGVyJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVW5kZWFkIGV4dGVuZHMgQ2hhcmFjdGVyIHtcbiAgY29uc3RydWN0b3IobGV2ZWwpIHtcbiAgICBzdXBlcihsZXZlbCwgJ3VuZGVhZCcpO1xuICAgIHRoaXMuYXR0YWNrID0gNDA7XG4gICAgdGhpcy5kZWZlbmNlID0gMTA7XG4gICAgdGhpcy5hdHRhY2tEaXN0YW5jZSA9IDE7XG4gICAgdGhpcy5tb3ZlRGlzdGFuY2UgPSA0O1xuICAgIHRoaXMudGVhbSA9ICdjb21wJztcbiAgfVxufVxuIiwiaW1wb3J0IENoYXJhY3RlciBmcm9tICcuLi9DaGFyYWN0ZXInO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWYW1waXJlIGV4dGVuZHMgQ2hhcmFjdGVyIHtcbiAgY29uc3RydWN0b3IobGV2ZWwpIHtcbiAgICBzdXBlcihsZXZlbCwgJ3ZhbXBpcmUnKTtcbiAgICB0aGlzLmF0dGFjayA9IDI1O1xuICAgIHRoaXMuZGVmZW5jZSA9IDI1O1xuICAgIHRoaXMuYXR0YWNrRGlzdGFuY2UgPSAyO1xuICAgIHRoaXMubW92ZURpc3RhbmNlID0gMjtcbiAgICB0aGlzLnRlYW0gPSAnY29tcCc7XG4gIH1cbn1cbiIsImltcG9ydCBCb3dtYW4gZnJvbSAnLi9jaGFyYWN0ZXJzL0Jvd21hbic7XG5pbXBvcnQgRGFlbW9uIGZyb20gJy4vY2hhcmFjdGVycy9EYWVtb24nO1xuaW1wb3J0IE1hZ2ljaWFuIGZyb20gJy4vY2hhcmFjdGVycy9NYWdpY2lhbic7XG5pbXBvcnQgU3dvcmRzbWFuIGZyb20gJy4vY2hhcmFjdGVycy9Td29yZHNtYW4nO1xuaW1wb3J0IFVuZGVhZCBmcm9tICcuL2NoYXJhY3RlcnMvVW5kZWFkJztcbmltcG9ydCBWYW1waXJlIGZyb20gJy4vY2hhcmFjdGVycy9WYW1waXJlJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGVhbSB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMudGVhbUNvbXAgPSBbRGFlbW9uLCBVbmRlYWQsIFZhbXBpcmVdO1xuICAgIHRoaXMudGVhbUh1bWFuSW5pdCA9IFtCb3dtYW4sIFN3b3Jkc21hbl07XG4gICAgdGhpcy50ZWFtSHVtYW4gPSBbQm93bWFuLCBNYWdpY2lhbiwgU3dvcmRzbWFuXTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZVN0YXRlIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5wbGF5ZXJzVHVybiA9IHRydWU7XG4gICAgdGhpcy5sZXZlbCA9IDE7XG4gICAgdGhpcy5wb2ludHMgPSAwO1xuICAgIHRoaXMuaGlnaGVzdFBvaW50cyA9IDA7XG5cbiAgICB0aGlzLnBvc2l0aW9uZWQgPSBbXTtcbiAgfVxuXG4gIHN0YXRpYyBmcm9tKG9iamVjdCkge1xuICAgIGlmICh0eXBlb2Ygb2JqZWN0ID09PSAnb2JqZWN0Jykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb2JqZWN0LFxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbiIsIi8qKlxuICogRW50cnkgcG9pbnQgb2YgYXBwOiBkb24ndCBjaGFuZ2UgdGhpc1xuICovXG5pbXBvcnQgR2FtZVBsYXkgZnJvbSAnLi9HYW1lUGxheSc7XG5pbXBvcnQgR2FtZUNvbnRyb2xsZXIgZnJvbSAnLi9HYW1lQ29udHJvbGxlcic7XG5pbXBvcnQgR2FtZVN0YXRlU2VydmljZSBmcm9tICcuL0dhbWVTdGF0ZVNlcnZpY2UnO1xuXG5jb25zdCBnYW1lUGxheSA9IG5ldyBHYW1lUGxheSgpO1xuZ2FtZVBsYXkuYmluZFRvRE9NKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNnYW1lLWNvbnRhaW5lcicpKTtcblxuY29uc3Qgc3RhdGVTZXJ2aWNlID0gbmV3IEdhbWVTdGF0ZVNlcnZpY2UobG9jYWxTdG9yYWdlKTtcblxuY29uc3QgZ2FtZUN0cmwgPSBuZXcgR2FtZUNvbnRyb2xsZXIoZ2FtZVBsYXksIHN0YXRlU2VydmljZSk7XG5nYW1lQ3RybC5pbml0KCk7XG5cbi8vIGRvbid0IHdyaXRlIHlvdXIgY29kZSBoZXJlXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lU3RhdGVTZXJ2aWNlIHtcbiAgY29uc3RydWN0b3Ioc3RvcmFnZSkge1xuICAgIHRoaXMuc3RvcmFnZSA9IHN0b3JhZ2U7XG4gIH1cblxuICBzYXZlKHN0YXRlKSB7XG4gICAgdGhpcy5zdG9yYWdlLnNldEl0ZW0oJ3N0YXRlJywgSlNPTi5zdHJpbmdpZnkoc3RhdGUpKTtcbiAgfVxuXG4gIGxvYWQoKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKHRoaXMuc3RvcmFnZS5nZXRJdGVtKCdzdGF0ZScpKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgc3RhdGUnKTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB0aGVtZXMgZnJvbSAnLi90aGVtZXMnO1xuaW1wb3J0IGN1cnNvcnMgZnJvbSAnLi9jdXJzb3JzJztcbmltcG9ydCB7IHBvc3NpYmxlTW92ZSwgY291bnRQb3NzaWJsZUluZGV4ZXMsIHNldFRpbWVyIH0gZnJvbSAnLi91dGlscyc7XG5cbmltcG9ydCB7XG4gIGdlbmVyYXRlVGVhbSxcbiAgZ2VuZXJhdGVQb3NpdGlvbixcbiAgY2hhcmFjdGVyR2VuZXJhdG9yLFxufSBmcm9tICcuL2dlbmVyYXRvcnMnO1xuXG5pbXBvcnQgVGVhbSBmcm9tICcuL1RlYW0nO1xuaW1wb3J0IEdhbWVQbGF5IGZyb20gJy4vR2FtZVBsYXknO1xuaW1wb3J0IEdhbWVTdGF0ZSBmcm9tICcuL0dhbWVTdGF0ZSc7XG5cbmltcG9ydCBCb3dtYW4gZnJvbSAnLi9jaGFyYWN0ZXJzL0Jvd21hbic7XG5pbXBvcnQgRGFlbW9uIGZyb20gJy4vY2hhcmFjdGVycy9EYWVtb24nO1xuaW1wb3J0IE1hZ2ljaWFuIGZyb20gJy4vY2hhcmFjdGVycy9NYWdpY2lhbic7XG5pbXBvcnQgU3dvcmRzbWFuIGZyb20gJy4vY2hhcmFjdGVycy9Td29yZHNtYW4nO1xuaW1wb3J0IFVuZGVhZCBmcm9tICcuL2NoYXJhY3RlcnMvVW5kZWFkJztcbmltcG9ydCBWYW1waXJlIGZyb20gJy4vY2hhcmFjdGVycy9WYW1waXJlJztcbmltcG9ydCBQb3NpdGlvbmVkQ2hhcmFjdGVyIGZyb20gJy4vUG9zaXRpb25lZENoYXJhY3Rlcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbWVDb250cm9sbGVyIHtcbiAgY29uc3RydWN0b3IoZ2FtZVBsYXksIHN0YXRlU2VydmljZSkge1xuICAgIHRoaXMuZ2FtZVBsYXkgPSBnYW1lUGxheTtcbiAgICB0aGlzLnN0YXRlU2VydmljZSA9IHN0YXRlU2VydmljZTtcbiAgICB0aGlzLmdhbWVTdGF0ZSA9IG5ldyBHYW1lU3RhdGUoKTtcbiAgICB0aGlzLnNlbGVjdGVkQ2hhcmFjdGVyID0gZmFsc2U7XG4gICAgdGhpcy5pbmRleE9mU2VsZWN0ZWRDaGFyYWN0ZXIgPSBudWxsO1xuICAgIHRoaXMucHJldmlvdXNseVNlbGVjdGVkID0gbnVsbDtcbiAgfVxuXG4gIGluaXQoKSB7XG4gICAgdGhpcy5wcmVwYXJlQm9hcmQoKTtcbiAgICB0aGlzLmRyYXdDaGFyYWN0ZXJzKCk7XG4gIH1cblxuICBwcmVwYXJlQm9hcmQoKSB7XG4gICAgdGhpcy5nYW1lUGxheS5kcmF3VWkoT2JqZWN0LnZhbHVlcyh0aGVtZXMpW3RoaXMuZ2FtZVN0YXRlLmxldmVsIC0gMV0pO1xuICAgIHRoaXMucmVtb3ZlTGlzdGVuZXJzKCk7XG4gICAgdGhpcy5hZGRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLnNob3dTdGF0cygpO1xuICB9XG5cbiAgZHJhd0NoYXJhY3RlcnMoKSB7XG4gICAgdGhpcy50ZWFtSHVtYW4gPSBnZW5lcmF0ZVRlYW0obmV3IFRlYW0oKS50ZWFtSHVtYW5Jbml0LCAxLCAyKTtcbiAgICB0aGlzLnRlYW1Db21wID0gZ2VuZXJhdGVUZWFtKG5ldyBUZWFtKCkudGVhbUNvbXAsIDEsIDIpO1xuICAgIHRoaXMucG9zVGVhbUh1bWFuID0gZ2VuZXJhdGVQb3NpdGlvbih0aGlzLnRlYW1IdW1hbiwgJ2h1bWFuJyk7XG4gICAgdGhpcy5wb3NUZWFtQ29tcCA9IGdlbmVyYXRlUG9zaXRpb24odGhpcy50ZWFtQ29tcCwgJ2NvbXAnKTtcblxuICAgIHRoaXMuZ2FtZVN0YXRlLnBvc2l0aW9uZWQgPSBbLi4udGhpcy5wb3NUZWFtSHVtYW4sIC4uLnRoaXMucG9zVGVhbUNvbXBdO1xuXG4gICAgdGhpcy5nYW1lUGxheS5yZWRyYXdQb3NpdGlvbnModGhpcy5nYW1lU3RhdGUucG9zaXRpb25lZCk7XG4gIH1cblxuICBvbkNlbGxFbnRlcihpbmRleCkge1xuICAgIGNvbnN0IGNoYXJhY3RlckhlcmUgPSB0aGlzLmZpbmRDaGFyYWN0ZXJIZXJlKGluZGV4KTtcblxuICAgIGlmIChjaGFyYWN0ZXJIZXJlKSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGxldmVsLCBhdHRhY2ssIGRlZmVuY2UsIGhlYWx0aCxcbiAgICAgIH0gPSBjaGFyYWN0ZXJIZXJlLmNoYXJhY3RlcjtcblxuICAgICAgdGhpcy5nYW1lUGxheS5zaG93Q2VsbFRvb2x0aXAoXG4gICAgICAgIGDwn46WJHtsZXZlbH0g4pqUJHthdHRhY2t9IPCfm6Eke2RlZmVuY2V9IOKdpCR7aGVhbHRofWAsXG4gICAgICAgIGluZGV4LFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pbmRleE9mU2VsZWN0ZWRDaGFyYWN0ZXIgJiYgdGhpcy5zZWxlY3RlZENoYXJhY3Rlcikge1xuICAgICAgY29uc3QgbnVtT2ZTdGVwc1RvTW92ZSA9IHRoaXMuZmluZE51bWJlck9mU3RlcHNUb01vdmUoKTtcbiAgICAgIGNvbnN0IG51bU9mU3RlcHNUb0F0dGFjayA9IHRoaXMuZmluZE51bWJlck9mU3RlcHNUb0F0dGFjaygpO1xuXG4gICAgICBpZiAobnVtT2ZTdGVwc1RvTW92ZSB8fCBudW1PZlN0ZXBzVG9BdHRhY2spIHtcbiAgICAgICAgY29uc3QgYWxsb3dlZE1vdmUgPSBwb3NzaWJsZU1vdmUoXG4gICAgICAgICAgdGhpcy5pbmRleE9mU2VsZWN0ZWRDaGFyYWN0ZXIsXG4gICAgICAgICAgaW5kZXgsXG4gICAgICAgICAgbnVtT2ZTdGVwc1RvTW92ZSxcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgYWxsb3dlZEF0dGFjayA9IHBvc3NpYmxlTW92ZShcbiAgICAgICAgICB0aGlzLmluZGV4T2ZTZWxlY3RlZENoYXJhY3RlcixcbiAgICAgICAgICBpbmRleCxcbiAgICAgICAgICBudW1PZlN0ZXBzVG9BdHRhY2ssXG4gICAgICAgICk7XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkQ2hhcmFjdGVyKSB7XG4gICAgICAgICAgaWYgKGFsbG93ZWRNb3ZlICYmICF0aGlzLmZpbmRDaGFyYWN0ZXJIZXJlKGluZGV4KSkge1xuICAgICAgICAgICAgdGhpcy5nYW1lUGxheS5zZWxlY3RDZWxsKGluZGV4LCAnZ3JlZW4nKTtcbiAgICAgICAgICAgIHRoaXMuZ2FtZVBsYXkuc2V0Q3Vyc29yKGN1cnNvcnMucG9pbnRlcik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghYWxsb3dlZE1vdmUpIHtcbiAgICAgICAgICAgIHRoaXMuZ2FtZVBsYXkuc2V0Q3Vyc29yKGN1cnNvcnMubm90YWxsb3dlZCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjaGFyYWN0ZXJIZXJlPy5jaGFyYWN0ZXIudGVhbSA9PT0gJ2NvbXAnICYmIGFsbG93ZWRBdHRhY2spIHtcbiAgICAgICAgICAgIHRoaXMuZ2FtZVBsYXkuc2VsZWN0Q2VsbChpbmRleCwgJ3JlZCcpO1xuICAgICAgICAgICAgdGhpcy5nYW1lUGxheS5zZXRDdXJzb3IoY3Vyc29ycy5jcm9zc2hhaXIpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoY2hhcmFjdGVySGVyZT8uY2hhcmFjdGVyLnRlYW0gPT09ICdodW1hbicpIHtcbiAgICAgICAgICAgIHRoaXMuZ2FtZVBsYXkuc2VsZWN0Q2VsbChpbmRleCwgJycpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIG9uQ2VsbExlYXZlKGluZGV4KSB7XG4gICAgdGhpcy5nYW1lUGxheS5oaWRlQ2VsbFRvb2x0aXAoaW5kZXgpO1xuICAgIGlmIChpbmRleCAhPT0gdGhpcy5pbmRleE9mU2VsZWN0ZWRDaGFyYWN0ZXIpIHtcbiAgICAgIHRoaXMuZ2FtZVBsYXkuZGVzZWxlY3RDZWxsKGluZGV4KTtcbiAgICAgIHRoaXMuZ2FtZVBsYXkuc2V0Q3Vyc29yKGN1cnNvcnMucG9pbnRlcik7XG4gICAgfVxuICB9XG5cbiAgb25DZWxsQ2xpY2soaW5kZXgpIHtcbiAgICBpZiAodGhpcy5nYW1lU3RhdGUucGxheWVyc1R1cm4pIHtcbiAgICAgIGlmIChcbiAgICAgICAgdGhpcy5wb3NUZWFtSHVtYW4ubGVuZ3RoID4gMFxuICAgICAgICAmJiB0aGlzLmdhbWVTdGF0ZS5sZXZlbCA8PSA0XG4gICAgICAgICYmIHRoaXMucG9zVGVhbUNvbXAubGVuZ3RoICE9PSAwXG4gICAgICApIHtcbiAgICAgICAgY29uc3QgY2hhcmFjdGVySGVyZSA9IHRoaXMuZmluZENoYXJhY3RlckhlcmUoaW5kZXgpO1xuICAgICAgICBpZiAoY2hhcmFjdGVySGVyZSkge1xuICAgICAgICAgIGNvbnN0IHsgdGVhbSB9ID0gY2hhcmFjdGVySGVyZS5jaGFyYWN0ZXI7XG4gICAgICAgICAgaWYgKHRlYW0gPT09ICdjb21wJyAmJiAhdGhpcy5zZWxlY3RlZENoYXJhY3Rlcikge1xuICAgICAgICAgICAgR2FtZVBsYXkuc2hvd0Vycm9yKCdJdCBpcyBub3QgeW91ciBjaGFyYWN0ZXIuIENob29zZSB5b3VycycpO1xuICAgICAgICAgICAgdGhpcy5nYW1lUGxheS5kZXNlbGVjdENlbGwodGhpcy5pbmRleE9mU2VsZWN0ZWRDaGFyYWN0ZXIgfHwgaW5kZXgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnByZXZpb3VzbHlTZWxlY3RlZCA9IHRoaXMuc2VsZWN0ZWRDaGFyYWN0ZXI7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkQ2hhcmFjdGVyID0gY2hhcmFjdGVySGVyZTtcbiAgICAgICAgICAgIHRoaXMuZ2FtZVBsYXkuZGVzZWxlY3RDZWxsKHRoaXMuaW5kZXhPZlNlbGVjdGVkQ2hhcmFjdGVyIHx8IGluZGV4KTtcbiAgICAgICAgICAgIHRoaXMuZ2FtZVBsYXkuc2VsZWN0Q2VsbChpbmRleCk7XG4gICAgICAgICAgICB0aGlzLmluZGV4T2ZTZWxlY3RlZENoYXJhY3RlciA9IGluZGV4O1xuICAgICAgICAgICAgdGhpcy5nYW1lUGxheS5zZXRDdXJzb3IoY3Vyc29ycy5wb2ludGVyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoIXRoaXMuc2VsZWN0ZWRDaGFyYWN0ZXIpIHtcbiAgICAgICAgICBHYW1lUGxheS5zaG93RXJyb3IoXG4gICAgICAgICAgICAnVGhlcmUgaXMgbm8gY2hhcmFjdGVyIGhlcmUuIENob29zZSBhbnkgY2VsbCB3aXRoIGEgY2hhcmFjdGVyJyxcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMucHJldmlvdXNseVNlbGVjdGVkICYmIGNoYXJhY3RlckhlcmUpIHtcbiAgICAgICAgICBjb25zdCBudW1PZlN0ZXBzID0gdGhpcy5wcmV2aW91c2x5U2VsZWN0ZWQuY2hhcmFjdGVyLmF0dGFja0Rpc3RhbmNlO1xuXG4gICAgICAgICAgY29uc3QgYWxsb3dlZEF0dGFjayA9IHBvc3NpYmxlTW92ZShcbiAgICAgICAgICAgIHRoaXMucHJldmlvdXNseVNlbGVjdGVkLnBvc2l0aW9uLFxuICAgICAgICAgICAgaW5kZXgsXG4gICAgICAgICAgICBudW1PZlN0ZXBzLFxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3QgeyB0ZWFtIH0gPSBjaGFyYWN0ZXJIZXJlLmNoYXJhY3RlcjtcbiAgICAgICAgICBpZiAodGVhbSA9PT0gJ2h1bWFuJykge1xuICAgICAgICAgICAgdGhpcy5nYW1lUGxheS5kZXNlbGVjdENlbGwodGhpcy5pbmRleE9mU2VsZWN0ZWRDaGFyYWN0ZXIpO1xuICAgICAgICAgICAgdGhpcy5nYW1lUGxheS5zZWxlY3RDZWxsKGluZGV4KTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGFsbG93ZWRBdHRhY2spIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbXBldGl0aW9uID0gY2hhcmFjdGVySGVyZTtcbiAgICAgICAgICAgIGNvbnN0IGRhbWFnZVZhbHVlID0gTWF0aC5tYXgoXG4gICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRDaGFyYWN0ZXIuY2hhcmFjdGVyLmF0dGFja1xuICAgICAgICAgICAgICAgIC0gY29tcGV0aXRpb24uY2hhcmFjdGVyLmRlZmVuY2UsXG4gICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRDaGFyYWN0ZXIuY2hhcmFjdGVyLmF0dGFjayAqIDAuMSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBkYW1hZ2UgPSB0aGlzLmdhbWVQbGF5LnNob3dEYW1hZ2UoaW5kZXgsIGRhbWFnZVZhbHVlKTtcblxuICAgICAgICAgICAgZGFtYWdlLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICBjb21wZXRpdGlvbi5jaGFyYWN0ZXIuaGVhbHRoIC09IGRhbWFnZVZhbHVlO1xuXG4gICAgICAgICAgICAgIGNvbnN0IHJlbW92ZWQgPSB0aGlzLnBvc1RlYW1Db21wLmluZGV4T2YoY29tcGV0aXRpb24pO1xuICAgICAgICAgICAgICBpZiAoY29tcGV0aXRpb24uY2hhcmFjdGVyLmhlYWx0aCA8PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3NUZWFtQ29tcC5zcGxpY2UocmVtb3ZlZCwgMSk7XG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucG9zaXRpb25lZCA9IFtcbiAgICAgICAgICAgICAgICAgIC4uLnRoaXMucG9zVGVhbUh1bWFuLFxuICAgICAgICAgICAgICAgICAgLi4udGhpcy5wb3NUZWFtQ29tcCxcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBvc1RlYW1Db21wLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyc1R1cm4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgdGhpcy5sZXZlbFVwKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RlZCgpO1xuICAgICAgICAgICAgICB0aGlzLmdhbWVQbGF5LnJlZHJhd1Bvc2l0aW9ucyh0aGlzLmdhbWVTdGF0ZS5wb3NpdGlvbmVkKTtcbiAgICAgICAgICAgICAgdGhpcy5jb21wdXRlcnNNb3ZlKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZENoYXJhY3RlciA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmluZGV4T2ZTZWxlY3RlZENoYXJhY3RlciA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXJzVHVybiA9IGZhbHNlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBHYW1lUGxheS5zaG93RXJyb3IoJ0l0IGlzIHRvbyBmYXIgdG8gYXR0YWNrIHRoaXMgY2hhcmFjdGVyJyk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkQ2hhcmFjdGVyID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMucHJldmlvdXNseVNlbGVjdGVkID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlU2VsZWN0ZWQoKTtcbiAgICAgICAgICAgIHRoaXMuY29tcHV0ZXJzTW92ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghY2hhcmFjdGVySGVyZSAmJiB0aGlzLnNlbGVjdGVkQ2hhcmFjdGVyKSB7XG4gICAgICAgICAgY29uc3QgbnVtT2ZTdGVwcyA9IHRoaXMuZmluZE51bWJlck9mU3RlcHNUb01vdmUoKTtcbiAgICAgICAgICBjb25zdCBhbGxvd2VkTW92ZSA9IHBvc3NpYmxlTW92ZShcbiAgICAgICAgICAgIHRoaXMuaW5kZXhPZlNlbGVjdGVkQ2hhcmFjdGVyLFxuICAgICAgICAgICAgaW5kZXgsXG4gICAgICAgICAgICBudW1PZlN0ZXBzLFxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKGFsbG93ZWRNb3ZlKSB7XG4gICAgICAgICAgICB0aGlzLnBvc1RlYW1IdW1hbiA9IFsuLi50aGlzLnBvc1RlYW1IdW1hbl0uZmlsdGVyKFxuICAgICAgICAgICAgICAoY2hhcmFjdGVyKSA9PiBjaGFyYWN0ZXIucG9zaXRpb24gIT09IHRoaXMuaW5kZXhPZlNlbGVjdGVkQ2hhcmFjdGVyLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRDaGFyYWN0ZXIucG9zaXRpb24gPSBpbmRleDtcbiAgICAgICAgICAgIHRoaXMucG9zVGVhbUh1bWFuLnB1c2godGhpcy5zZWxlY3RlZENoYXJhY3Rlcik7XG4gICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wb3NpdGlvbmVkID0gW1xuICAgICAgICAgICAgICAuLi50aGlzLnBvc1RlYW1IdW1hbixcbiAgICAgICAgICAgICAgLi4udGhpcy5wb3NUZWFtQ29tcCxcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkQ2hhcmFjdGVyID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuaW5kZXhPZlNlbGVjdGVkQ2hhcmFjdGVyID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuZ2FtZVBsYXkucmVkcmF3UG9zaXRpb25zKHRoaXMuZ2FtZVN0YXRlLnBvc2l0aW9uZWQpO1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RlZCgpO1xuICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyc1R1cm4gPSBmYWxzZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgR2FtZVBsYXkuc2hvd0Vycm9yKCdJdCBpcyBub3QgYWxsb3dlZCB0byBtb3ZlIHRoZXJlJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuY29tcHV0ZXJzTW92ZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIEdhbWVQbGF5LnNob3dFcnJvcignSXQgaXMgbm90IHlvdXIgdHVybiB5ZXQnKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBjb21wdXRlcnNNb3ZlKCkge1xuICAgIGlmICghdGhpcy5nYW1lU3RhdGUucGxheWVyc1R1cm4pIHtcbiAgICAgIGF3YWl0IHNldFRpbWVyKDMwMCk7XG4gICAgICBjb25zdCBpbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMucG9zVGVhbUNvbXAubGVuZ3RoKTtcbiAgICAgIGNvbnN0IHBsYXlpbmdDaGFyYWN0ZXIgPSB0aGlzLnBvc1RlYW1Db21wW2luZGV4XTtcbiAgICAgIGNvbnN0IHBsYXlpbmdDaGFyYWN0ZXJJbmRleCA9IHBsYXlpbmdDaGFyYWN0ZXIucG9zaXRpb247XG4gICAgICBjb25zdCBudW1PZlN0ZXBzVG9Nb3ZlID0gcGxheWluZ0NoYXJhY3Rlci5jaGFyYWN0ZXIubW92ZURpc3RhbmNlO1xuICAgICAgY29uc3QgbnVtT2ZTdGVwc1RvQXR0YWNrID0gcGxheWluZ0NoYXJhY3Rlci5jaGFyYWN0ZXIuYXR0YWNrRGlzdGFuY2U7XG4gICAgICBjb25zdCBodW1hbnNQb3NpdGlvbnMgPSB0aGlzLnBvc1RlYW1IdW1hbi5tYXAoXG4gICAgICAgIChlbGVtZW50KSA9PiBlbGVtZW50LnBvc2l0aW9uLFxuICAgICAgKTtcbiAgICAgIGNvbnN0IGNvbXBzUG9zaXRpb25zID0gdGhpcy5wb3NUZWFtQ29tcC5tYXAoXG4gICAgICAgIChlbGVtZW50KSA9PiBlbGVtZW50LnBvc2l0aW9uLFxuICAgICAgKTtcbiAgICAgIGNvbnN0IHBvc3NpYmxlTW92ZXMgPSBjb3VudFBvc3NpYmxlSW5kZXhlcyhcbiAgICAgICAgcGxheWluZ0NoYXJhY3RlckluZGV4LFxuICAgICAgICBudW1PZlN0ZXBzVG9Nb3ZlLFxuICAgICAgKVxuICAgICAgICAuZmlsdGVyKChtb3ZlKSA9PiBjb21wc1Bvc2l0aW9ucy5pbmRleE9mKG1vdmUpID09PSAtMSlcbiAgICAgICAgLmZpbHRlcigobW92ZSkgPT4gaHVtYW5zUG9zaXRpb25zLmluZGV4T2YobW92ZSkgPT09IC0xKTtcblxuICAgICAgY29uc3QgcG9zc2libGVBdHRhY2tzID0gY291bnRQb3NzaWJsZUluZGV4ZXMoXG4gICAgICAgIHBsYXlpbmdDaGFyYWN0ZXJJbmRleCxcbiAgICAgICAgbnVtT2ZTdGVwc1RvQXR0YWNrLFxuICAgICAgKTtcblxuICAgICAgY29uc3QgcG9zc2libGVBdHRhY2sgPSBwb3NzaWJsZUF0dGFja3MuZmlsdGVyKFxuICAgICAgICAobW92ZSkgPT4gaHVtYW5zUG9zaXRpb25zLmluZGV4T2YobW92ZSkgPiAtMSxcbiAgICAgICk7XG4gICAgICBsZXQgdG9BdHRhY2sgPSBudWxsO1xuICAgICAgaWYgKHBvc3NpYmxlQXR0YWNrLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICB0b0F0dGFjayA9IHBvc3NpYmxlQXR0YWNrWzBdO1xuICAgICAgfSBlbHNlIGlmIChwb3NzaWJsZUF0dGFjay5sZW5ndGggPiAxKSB7XG4gICAgICAgIHRvQXR0YWNrID0gcG9zc2libGVBdHRhY2tbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcG9zc2libGVBdHRhY2subGVuZ3RoKV07XG4gICAgICB9XG5cbiAgICAgIGlmICghdG9BdHRhY2spIHtcbiAgICAgICAgdGhpcy5wb3NUZWFtQ29tcCA9IFsuLi50aGlzLnBvc1RlYW1Db21wXS5maWx0ZXIoXG4gICAgICAgICAgKGNoYXJhY3RlcikgPT4gY2hhcmFjdGVyLnBvc2l0aW9uICE9PSBwbGF5aW5nQ2hhcmFjdGVySW5kZXgsXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5nYW1lUGxheS5zZWxlY3RDZWxsKHBsYXlpbmdDaGFyYWN0ZXIucG9zaXRpb24pO1xuICAgICAgICBhd2FpdCBzZXRUaW1lcigzMDApO1xuICAgICAgICB0aGlzLmdhbWVQbGF5LmRlc2VsZWN0Q2VsbChwbGF5aW5nQ2hhcmFjdGVyLnBvc2l0aW9uKTtcblxuICAgICAgICBwbGF5aW5nQ2hhcmFjdGVyLnBvc2l0aW9uID0gcG9zc2libGVNb3Zlc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwb3NzaWJsZU1vdmVzLmxlbmd0aCldO1xuXG4gICAgICAgIHRoaXMuZ2FtZVBsYXkuc2VsZWN0Q2VsbChwbGF5aW5nQ2hhcmFjdGVyLnBvc2l0aW9uLCAnZ3JlZW4nKTtcbiAgICAgICAgYXdhaXQgc2V0VGltZXIoMzAwKTtcbiAgICAgICAgdGhpcy5nYW1lUGxheS5kZXNlbGVjdENlbGwocGxheWluZ0NoYXJhY3Rlci5wb3NpdGlvbik7XG5cbiAgICAgICAgdGhpcy5wb3NUZWFtQ29tcC5wdXNoKHBsYXlpbmdDaGFyYWN0ZXIpO1xuICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wb3NpdGlvbmVkID0gWy4uLnRoaXMucG9zVGVhbUh1bWFuLCAuLi50aGlzLnBvc1RlYW1Db21wXTtcblxuICAgICAgICB0aGlzLmdhbWVQbGF5LnJlZHJhd1Bvc2l0aW9ucyh0aGlzLmdhbWVTdGF0ZS5wb3NpdGlvbmVkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGVuZW15ID0gdGhpcy5maW5kQ2hhcmFjdGVySGVyZSh0b0F0dGFjayk7XG5cbiAgICAgICAgY29uc3QgZGFtYWdlVmFsdWUgPSBNYXRoLm1heChcbiAgICAgICAgICBwbGF5aW5nQ2hhcmFjdGVyLmNoYXJhY3Rlci5hdHRhY2sgLSBlbmVteS5jaGFyYWN0ZXIuZGVmZW5jZSxcbiAgICAgICAgICBwbGF5aW5nQ2hhcmFjdGVyLmNoYXJhY3Rlci5hdHRhY2sgKiAwLjEsXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5nYW1lUGxheS5zZWxlY3RDZWxsKHBsYXlpbmdDaGFyYWN0ZXIucG9zaXRpb24pO1xuICAgICAgICBhd2FpdCBzZXRUaW1lcigzMDApO1xuICAgICAgICB0aGlzLmdhbWVQbGF5LnNlbGVjdENlbGwodG9BdHRhY2ssICdyZWQnKTtcblxuICAgICAgICBjb25zdCBkYW1hZ2UgPSB0aGlzLmdhbWVQbGF5LnNob3dEYW1hZ2UodG9BdHRhY2ssIGRhbWFnZVZhbHVlKTtcblxuICAgICAgICB0aGlzLmdhbWVQbGF5LmRlc2VsZWN0Q2VsbChwbGF5aW5nQ2hhcmFjdGVyLnBvc2l0aW9uKTtcblxuICAgICAgICBkYW1hZ2UudGhlbigoKSA9PiB7XG4gICAgICAgICAgZW5lbXkuY2hhcmFjdGVyLmhlYWx0aCAtPSBkYW1hZ2VWYWx1ZTtcbiAgICAgICAgICBjb25zdCByZW1vdmVkID0gdGhpcy5wb3NUZWFtSHVtYW4uaW5kZXhPZihlbmVteSk7XG4gICAgICAgICAgaWYgKGVuZW15LmNoYXJhY3Rlci5oZWFsdGggPD0gMCkge1xuICAgICAgICAgICAgdGhpcy5wb3NUZWFtSHVtYW4uc3BsaWNlKHJlbW92ZWQsIDEpO1xuICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucG9zaXRpb25lZCA9IFtcbiAgICAgICAgICAgICAgLi4udGhpcy5wb3NUZWFtSHVtYW4sXG4gICAgICAgICAgICAgIC4uLnRoaXMucG9zVGVhbUNvbXAsXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgaWYgKHRoaXMucG9zVGVhbUh1bWFuLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICBHYW1lUGxheS5zaG93TWVzc2FnZSgnWW91IGxvc3QuIEJldHRlciBsdWNrIG5leHQgdGltZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMuZ2FtZVBsYXkucmVkcmF3UG9zaXRpb25zKHRoaXMuZ2FtZVN0YXRlLnBvc2l0aW9uZWQpO1xuXG4gICAgICAgICAgdGhpcy5nYW1lUGxheS5kZXNlbGVjdENlbGwodG9BdHRhY2spO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcnNUdXJuID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyc1R1cm4gPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGxldmVsVXAoKSB7XG4gICAgaWYgKHRoaXMuZ2FtZVN0YXRlLmxldmVsIDw9IDQpIHtcbiAgICAgIHRoaXMuZ2FtZVN0YXRlLnBvaW50cyArPSB0aGlzLnBvc1RlYW1IdW1hblxuICAgICAgICAubWFwKChlbGVtZW50KSA9PiBlbGVtZW50LmNoYXJhY3Rlci5oZWFsdGgpXG4gICAgICAgIC5yZWR1Y2UoKHN1bSwgbnVtYmVyKSA9PiBzdW0gKyBudW1iZXIpO1xuXG4gICAgICBpZiAodGhpcy5nYW1lU3RhdGUuaGlnaGVzdFBvaW50cyA8IHRoaXMuZ2FtZVN0YXRlLnBvaW50cykge1xuICAgICAgICB0aGlzLmdhbWVTdGF0ZS5oaWdoZXN0UG9pbnRzID0gdGhpcy5nYW1lU3RhdGUucG9pbnRzO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnNob3dTdGF0cygpO1xuXG4gICAgICBpZiAodGhpcy5nYW1lU3RhdGUubGV2ZWwgPCA0KSB7XG4gICAgICAgIHRoaXMuZ2FtZVN0YXRlLmxldmVsICs9IDE7XG4gICAgICAgIHRoaXMucHJlcGFyZUJvYXJkKCk7XG4gICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBvc2l0aW9uZWQuZm9yRWFjaCgoY2hhcmFjdGVyKSA9PiBjaGFyYWN0ZXIuY2hhcmFjdGVyLmxldmVsVXAoKSk7XG5cbiAgICAgICAgdGhpcy50ZWFtSHVtYW4gPSB0aGlzLnBvc1RlYW1IdW1hbi5tYXAoKGVsZW1lbnQpID0+IGVsZW1lbnQuY2hhcmFjdGVyKTtcbiAgICAgICAgdGhpcy50ZWFtSHVtYW4ucHVzaChcbiAgICAgICAgICBjaGFyYWN0ZXJHZW5lcmF0b3IoXG4gICAgICAgICAgICBuZXcgVGVhbSgpLnRlYW1IdW1hbixcbiAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLmxldmVsIC0gMSxcbiAgICAgICAgICApLm5leHQoKS52YWx1ZSxcbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLnBvc1RlYW1IdW1hbiA9IGdlbmVyYXRlUG9zaXRpb24odGhpcy50ZWFtSHVtYW4sICdodW1hbicpO1xuXG4gICAgICAgIHRoaXMudGVhbUNvbXAgPSBnZW5lcmF0ZVRlYW0oXG4gICAgICAgICAgbmV3IFRlYW0oKS50ZWFtQ29tcCxcbiAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5sZXZlbCxcbiAgICAgICAgICB0aGlzLnBvc1RlYW1IdW1hbi5sZW5ndGgsXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5wb3NUZWFtQ29tcCA9IGdlbmVyYXRlUG9zaXRpb24odGhpcy50ZWFtQ29tcCwgJ2NvbXAnKTtcblxuICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wb3NpdGlvbmVkID0gWy4uLnRoaXMucG9zVGVhbUh1bWFuLCAuLi50aGlzLnBvc1RlYW1Db21wXTtcblxuICAgICAgICB0aGlzLmdhbWVQbGF5LnJlZHJhd1Bvc2l0aW9ucyh0aGlzLmdhbWVTdGF0ZS5wb3NpdGlvbmVkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFsZXJ0KCdDb25ncmF0cyEgVGhpcyB3YXMgdGhlIGxhc3QgbGV2ZWwnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBvbk5ld0dhbWVDbGljaygpIHtcbiAgICB0aGlzLmRlc2VsZWN0KCk7XG4gICAgdGhpcy5nYW1lU3RhdGUucGxheWVyc1R1cm4gPSB0cnVlO1xuICAgIHRoaXMuZ2FtZVN0YXRlLmxldmVsID0gMTtcbiAgICB0aGlzLmdhbWVTdGF0ZS5wb2ludHMgPSAwO1xuXG4gICAgdGhpcy5pbml0KCk7XG4gIH1cblxuICBvblNhdmVHYW1lQ2xpY2soKSB7XG4gICAgdGhpcy5zdGF0ZVNlcnZpY2Uuc2F2ZSh0aGlzLmdhbWVTdGF0ZSk7XG5cbiAgICBHYW1lUGxheS5zaG93TWVzc2FnZSgnU2F2ZWQnKTtcbiAgfVxuXG4gIG9uTG9hZEdhbWUoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGxvYWRTdGF0ZSA9IHRoaXMuc3RhdGVTZXJ2aWNlLmxvYWQoKTtcbiAgICAgIGNvbnN0IHR5cGVzID0ge1xuICAgICAgICBzd29yZHNtYW46IFN3b3Jkc21hbixcbiAgICAgICAgYm93bWFuOiBCb3dtYW4sXG4gICAgICAgIG1hZ2ljaWFuOiBNYWdpY2lhbixcbiAgICAgICAgZGFlbW9uOiBEYWVtb24sXG4gICAgICAgIHVuZGVhZDogVW5kZWFkLFxuICAgICAgICB2YW1waXJlOiBWYW1waXJlLFxuICAgICAgfTtcblxuICAgICAgdGhpcy5kZXNlbGVjdCgpO1xuXG4gICAgICB0aGlzLmdhbWVTdGF0ZS5sZXZlbCA9IGxvYWRTdGF0ZS5sZXZlbDtcbiAgICAgIHRoaXMuZ2FtZVN0YXRlLnBvaW50cyA9IGxvYWRTdGF0ZS5wb2ludHM7XG4gICAgICB0aGlzLmdhbWVTdGF0ZS5oaWdoZXN0UG9pbnRzID0gbG9hZFN0YXRlLmhpZ2hlc3RQb2ludHM7XG4gICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXJzVHVybiA9IGxvYWRTdGF0ZS5wbGF5ZXJzVHVybjtcbiAgICAgIHRoaXMucHJlcGFyZUJvYXJkKCk7XG5cbiAgICAgIHRoaXMuZ2FtZVN0YXRlLnBvc2l0aW9uZWQgPSBsb2FkU3RhdGUucG9zaXRpb25lZC5tYXAoKGl0ZW0pID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGF0dGFjayxcbiAgICAgICAgICBhdHRhY2tEaXN0YW5jZSxcbiAgICAgICAgICBkZWZlbmNlLFxuICAgICAgICAgIGhlYWx0aCxcbiAgICAgICAgICBsZXZlbCxcbiAgICAgICAgICBtb3ZlRGlzdGFuY2UsXG4gICAgICAgICAgdGVhbSxcbiAgICAgICAgICB0eXBlLFxuICAgICAgICB9ID0gaXRlbS5jaGFyYWN0ZXI7XG5cbiAgICAgICAgY29uc3QgY2hhcmFjdGVyID0gbmV3IHR5cGVzW3R5cGVdKGxldmVsKTtcblxuICAgICAgICBjaGFyYWN0ZXIuYXR0YWNrID0gYXR0YWNrO1xuICAgICAgICBjaGFyYWN0ZXIuYXR0YWNrRGlzdGFuY2UgPSBhdHRhY2tEaXN0YW5jZTtcbiAgICAgICAgY2hhcmFjdGVyLmRlZmVuY2UgPSBkZWZlbmNlO1xuICAgICAgICBjaGFyYWN0ZXIuaGVhbHRoID0gaGVhbHRoO1xuICAgICAgICBjaGFyYWN0ZXIubW92ZURpc3RhbmNlID0gbW92ZURpc3RhbmNlO1xuICAgICAgICBjaGFyYWN0ZXIudGVhbSA9IHRlYW07XG5cbiAgICAgICAgcmV0dXJuIG5ldyBQb3NpdGlvbmVkQ2hhcmFjdGVyKGNoYXJhY3RlciwgaXRlbS5wb3NpdGlvbik7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5wb3NUZWFtSHVtYW4gPSB0aGlzLmdhbWVTdGF0ZS5wb3NpdGlvbmVkLmZpbHRlcihcbiAgICAgICAgKGNoYXJhY3RlcikgPT4gY2hhcmFjdGVyLmNoYXJhY3Rlci50ZWFtID09PSAnaHVtYW4nLFxuICAgICAgKTtcbiAgICAgIHRoaXMucG9zVGVhbUNvbXAgPSB0aGlzLmdhbWVTdGF0ZS5wb3NpdGlvbmVkLmZpbHRlcihcbiAgICAgICAgKGNoYXJhY3RlcikgPT4gY2hhcmFjdGVyLmNoYXJhY3Rlci50ZWFtID09PSAnY29tcCcsXG4gICAgICApO1xuXG4gICAgICBHYW1lUGxheS5zaG93TWVzc2FnZSgnTG9hZGVkJyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBHYW1lUGxheS5zaG93RXJyb3IoJ1NvbWV0aGluZyB3ZW50IHdyb25nJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5nYW1lUGxheS5yZWRyYXdQb3NpdGlvbnModGhpcy5nYW1lU3RhdGUucG9zaXRpb25lZCk7XG4gIH1cblxuICBhZGRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5nYW1lUGxheS5hZGRDZWxsRW50ZXJMaXN0ZW5lcih0aGlzLm9uQ2VsbEVudGVyLmJpbmQodGhpcykpO1xuICAgIHRoaXMuZ2FtZVBsYXkuYWRkQ2VsbExlYXZlTGlzdGVuZXIodGhpcy5vbkNlbGxMZWF2ZS5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmdhbWVQbGF5LmFkZENlbGxDbGlja0xpc3RlbmVyKHRoaXMub25DZWxsQ2xpY2suYmluZCh0aGlzKSk7XG5cbiAgICB0aGlzLmdhbWVQbGF5LmFkZE5ld0dhbWVMaXN0ZW5lcih0aGlzLm9uTmV3R2FtZUNsaWNrLmJpbmQodGhpcykpO1xuICAgIHRoaXMuZ2FtZVBsYXkuYWRkU2F2ZUdhbWVMaXN0ZW5lcih0aGlzLm9uU2F2ZUdhbWVDbGljay5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmdhbWVQbGF5LmFkZExvYWRHYW1lTGlzdGVuZXIodGhpcy5vbkxvYWRHYW1lLmJpbmQodGhpcykpO1xuICB9XG5cbiAgcmVtb3ZlTGlzdGVuZXJzKCkge1xuICAgIHRoaXMuZ2FtZVBsYXkuY2VsbENsaWNrTGlzdGVuZXJzID0gW107XG4gICAgdGhpcy5nYW1lUGxheS5jZWxsRW50ZXJMaXN0ZW5lcnMgPSBbXTtcbiAgICB0aGlzLmdhbWVQbGF5LmNlbGxMZWF2ZUxpc3RlbmVycyA9IFtdO1xuICAgIHRoaXMuZ2FtZVBsYXkubmV3R2FtZUxpc3RlbmVycyA9IFtdO1xuICAgIHRoaXMuZ2FtZVBsYXkuc2F2ZUdhbWVMaXN0ZW5lcnMgPSBbXTtcbiAgICB0aGlzLmdhbWVQbGF5LmxvYWRHYW1lTGlzdGVuZXJzID0gW107XG4gIH1cblxuICBkZXNlbGVjdCgpIHtcbiAgICB0aGlzLnJlbW92ZUxpc3RlbmVycygpO1xuICAgIHRoaXMuc2VsZWN0ZWRDaGFyYWN0ZXIgPSBmYWxzZTtcbiAgICB0aGlzLmluZGV4T2ZTZWxlY3RlZENoYXJhY3RlciA9IG51bGw7XG4gICAgdGhpcy5wcmV2aW91c2x5U2VsZWN0ZWQgPSBudWxsO1xuICB9XG5cbiAgc2hvd1N0YXRzKCkge1xuICAgIHRoaXMuZ2FtZVBsYXkuc2V0Q3VycmVudExldmVsKHRoaXMuZ2FtZVN0YXRlLmxldmVsKTtcbiAgICB0aGlzLmdhbWVQbGF5LnNldEN1cnJlbnRTY29yZSh0aGlzLmdhbWVTdGF0ZS5wb2ludHMpO1xuICAgIHRoaXMuZ2FtZVBsYXkuc2V0QmVzdFNjb3JlKHRoaXMuZ2FtZVN0YXRlLmhpZ2hlc3RQb2ludHMpO1xuICB9XG5cbiAgcmVtb3ZlU2VsZWN0ZWQoKSB7XG4gICAgdGhpcy5nYW1lUGxheS5jZWxscy5mb3JFYWNoKChjZWxsKSA9PiBjZWxsLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkLXllbGxvdycsICdzZWxlY3RlZC1ncmVlbicsICdzZWxlY3RlZC1yZWQnKSk7XG4gIH1cblxuICBmaW5kQ2hhcmFjdGVySGVyZShpbmRleCkge1xuICAgIHJldHVybiB0aGlzLmdhbWVTdGF0ZS5wb3NpdGlvbmVkLmZpbmQoXG4gICAgICAoY2hhcmFjdGVyKSA9PiBjaGFyYWN0ZXIucG9zaXRpb24gPT09IGluZGV4LFxuICAgICk7XG4gIH1cblxuICBmaW5kTnVtYmVyT2ZTdGVwc1RvTW92ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5zZWxlY3RlZENoYXJhY3Rlci5jaGFyYWN0ZXIubW92ZURpc3RhbmNlO1xuICB9XG5cbiAgZmluZE51bWJlck9mU3RlcHNUb0F0dGFjaygpIHtcbiAgICByZXR1cm4gdGhpcy5zZWxlY3RlZENoYXJhY3Rlci5jaGFyYWN0ZXIuYXR0YWNrRGlzdGFuY2U7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJjYWxjVGlsZVR5cGUiLCJpbmRleCIsImJvYXJkU2l6ZSIsInNxdWFyZSIsImNvdW50UG9zc2libGVJbmRleGVzIiwiY3VycmVudEluZGV4IiwibW92ZURpc3RhbmNlIiwicG9zc2libGVJbmRleGVzIiwiY291bnRSb3ciLCJ2YXJpYWJsZSIsIk1hdGgiLCJjZWlsIiwiaSIsInVwIiwiZG93biIsImxlZnQiLCJyaWdodCIsInVwUmlnaHREaWFnIiwidXBMZWZ0RGlhZyIsImRvd25SaWdodERpYWciLCJkb3duTGVmdERpYWciLCJjdXJyZW50SW5kZXhSb3ciLCJwdXNoIiwicG9zc2libGVNb3ZlIiwiZnV0dXJlSW5kZXgiLCJpbmNsdWRlcyIsInNldFRpbWVyIiwidGltZSIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsIkdhbWVQbGF5IiwiY29uc3RydWN0b3IiLCJ0aGlzIiwiY29udGFpbmVyIiwiYm9hcmRFbCIsImNlbGxzIiwiY2VsbENsaWNrTGlzdGVuZXJzIiwiY2VsbEVudGVyTGlzdGVuZXJzIiwiY2VsbExlYXZlTGlzdGVuZXJzIiwibmV3R2FtZUxpc3RlbmVycyIsInNhdmVHYW1lTGlzdGVuZXJzIiwibG9hZEdhbWVMaXN0ZW5lcnMiLCJiaW5kVG9ET00iLCJIVE1MRWxlbWVudCIsIkVycm9yIiwiZHJhd1VpIiwidGhlbWUiLCJjaGVja0JpbmRpbmciLCJpbm5lckhUTUwiLCJuZXdHYW1lRWwiLCJxdWVyeVNlbGVjdG9yIiwic2F2ZUdhbWVFbCIsImxvYWRHYW1lRWwiLCJjdXJyZW50TGV2ZWwiLCJjdXJyZW50U2NvcmUiLCJiZXN0U2NvcmUiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJvbk5ld0dhbWVDbGljayIsIm9uU2F2ZUdhbWVDbGljayIsIm9uTG9hZEdhbWVDbGljayIsImNsYXNzTGlzdCIsImFkZCIsImNlbGxFbCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsIm9uQ2VsbEVudGVyIiwib25DZWxsTGVhdmUiLCJvbkNlbGxDbGljayIsImFwcGVuZENoaWxkIiwiQXJyYXkiLCJmcm9tIiwiY2hpbGRyZW4iLCJyZWRyYXdQb3NpdGlvbnMiLCJwb3NpdGlvbnMiLCJjZWxsIiwicG9zaXRpb24iLCJjaGFyRWwiLCJjaGFyYWN0ZXIiLCJ0eXBlIiwiaGVhbHRoRWwiLCJoZWFsdGhJbmRpY2F0b3JFbCIsImhlYWx0aCIsInN0eWxlIiwid2lkdGgiLCJhZGRDZWxsRW50ZXJMaXN0ZW5lciIsImNhbGxiYWNrIiwiYWRkQ2VsbExlYXZlTGlzdGVuZXIiLCJhZGRDZWxsQ2xpY2tMaXN0ZW5lciIsImFkZE5ld0dhbWVMaXN0ZW5lciIsImFkZFNhdmVHYW1lTGlzdGVuZXIiLCJhZGRMb2FkR2FtZUxpc3RlbmVyIiwicHJldmVudERlZmF1bHQiLCJpbmRleE9mIiwiY3VycmVudFRhcmdldCIsImZvckVhY2giLCJvIiwiY2FsbCIsIm1lc3NhZ2UiLCJhbGVydCIsInNlbGVjdENlbGwiLCJjb2xvciIsImRlc2VsZWN0Q2VsbCIsInJlbW92ZSIsImZpbHRlciIsInN0YXJ0c1dpdGgiLCJzaG93Q2VsbFRvb2x0aXAiLCJ0aXRsZSIsImhpZGVDZWxsVG9vbHRpcCIsInNob3dEYW1hZ2UiLCJkYW1hZ2UiLCJkYW1hZ2VFbCIsInRleHRDb250ZW50IiwicmVtb3ZlQ2hpbGQiLCJzZXRDdXJzb3IiLCJjdXJzb3IiLCJzZXRDdXJyZW50TGV2ZWwiLCJsZXZlbCIsInNldEN1cnJlbnRTY29yZSIsInBvaW50cyIsInNldEJlc3RTY29yZSIsImhpZ2hlc3RQb2ludHMiLCJwcmFpcmllIiwiZGVzZXJ0IiwiYXJjdGljIiwibW91bnRhaW4iLCJDaGFyYWN0ZXIiLCJhdHRhY2siLCJkZWZlbmNlIiwibmFtZSIsImxldmVsVXAiLCJtYXgiLCJyb3VuZCIsIlBvc2l0aW9uZWRDaGFyYWN0ZXIiLCJjaGFyYWN0ZXJHZW5lcmF0b3IiLCJhbGxvd2VkVHlwZXMiLCJtYXhMZXZlbCIsImZsb29yIiwicmFuZG9tIiwibGVuZ3RoIiwiZ2VuZXJhdGVUZWFtIiwiY2hhcmFjdGVyQ291bnQiLCJ0ZWFtIiwibmV4dCIsInZhbHVlIiwiZ2VuZXJhdGVQb3NpdGlvbiIsInNpZGUiLCJhbGxDZWxscyIsImtleXMiLCJwb3NzaWJsZUNlbGxzIiwicG9zaXRpb25lZENoYXJhY3RlcnMiLCJzcGxpY2UiLCJCb3dtYW4iLCJzdXBlciIsImF0dGFja0Rpc3RhbmNlIiwiRGFlbW9uIiwiTWFnaWNpYW4iLCJTd29yZHNtYW4iLCJVbmRlYWQiLCJWYW1waXJlIiwiVGVhbSIsInRlYW1Db21wIiwidGVhbUh1bWFuSW5pdCIsInRlYW1IdW1hbiIsIkdhbWVTdGF0ZSIsInBsYXllcnNUdXJuIiwicG9zaXRpb25lZCIsIm9iamVjdCIsImdhbWVQbGF5Iiwic3RhdGVTZXJ2aWNlIiwic3RvcmFnZSIsInNhdmUiLCJzdGF0ZSIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwibG9hZCIsInBhcnNlIiwiZ2V0SXRlbSIsImUiLCJsb2NhbFN0b3JhZ2UiLCJnYW1lQ3RybCIsImdhbWVTdGF0ZSIsInNlbGVjdGVkQ2hhcmFjdGVyIiwiaW5kZXhPZlNlbGVjdGVkQ2hhcmFjdGVyIiwicHJldmlvdXNseVNlbGVjdGVkIiwiaW5pdCIsInByZXBhcmVCb2FyZCIsImRyYXdDaGFyYWN0ZXJzIiwiT2JqZWN0IiwidmFsdWVzIiwidGhlbWVzIiwicmVtb3ZlTGlzdGVuZXJzIiwiYWRkTGlzdGVuZXJzIiwic2hvd1N0YXRzIiwicG9zVGVhbUh1bWFuIiwicG9zVGVhbUNvbXAiLCJjaGFyYWN0ZXJIZXJlIiwiZmluZENoYXJhY3RlckhlcmUiLCJudW1PZlN0ZXBzVG9Nb3ZlIiwiZmluZE51bWJlck9mU3RlcHNUb01vdmUiLCJudW1PZlN0ZXBzVG9BdHRhY2siLCJmaW5kTnVtYmVyT2ZTdGVwc1RvQXR0YWNrIiwiYWxsb3dlZE1vdmUiLCJhbGxvd2VkQXR0YWNrIiwiY3Vyc29ycyIsInNob3dFcnJvciIsIm51bU9mU3RlcHMiLCJjb21wZXRpdGlvbiIsImRhbWFnZVZhbHVlIiwidGhlbiIsInJlbW92ZWQiLCJyZW1vdmVTZWxlY3RlZCIsImNvbXB1dGVyc01vdmUiLCJwbGF5aW5nQ2hhcmFjdGVyIiwicGxheWluZ0NoYXJhY3RlckluZGV4IiwiaHVtYW5zUG9zaXRpb25zIiwibWFwIiwiZWxlbWVudCIsImNvbXBzUG9zaXRpb25zIiwicG9zc2libGVNb3ZlcyIsIm1vdmUiLCJwb3NzaWJsZUF0dGFjayIsInRvQXR0YWNrIiwiZW5lbXkiLCJzaG93TWVzc2FnZSIsInJlZHVjZSIsInN1bSIsIm51bWJlciIsImRlc2VsZWN0Iiwib25Mb2FkR2FtZSIsImxvYWRTdGF0ZSIsInR5cGVzIiwic3dvcmRzbWFuIiwiYm93bWFuIiwibWFnaWNpYW4iLCJkYWVtb24iLCJ1bmRlYWQiLCJ2YW1waXJlIiwiaXRlbSIsImVyciIsImJpbmQiLCJmaW5kIl0sInNvdXJjZVJvb3QiOiIifQ==